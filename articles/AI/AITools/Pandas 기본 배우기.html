<!DOCTYPE html>
<html lang="kr"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Pandas ê¸°ë³¸ ë°°ìš°ê¸° | ğŸ§ SUBBRAIN</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Pandas ê¸°ë³¸ ë°°ìš°ê¸°" />
<meta property="og:locale" content="kr" />
<meta name="description" content="style: number min_depth: 2 max_depth: 3 varied_style: true Pandas ê¸°ë³¸ ë°°ìš°ê¸°" />
<meta property="og:description" content="style: number min_depth: 2 max_depth: 3 varied_style: true Pandas ê¸°ë³¸ ë°°ìš°ê¸°" />
<link rel="canonical" href="http://localhost:4000/articles/AI/AITools/Pandas%20%EA%B8%B0%EB%B3%B8%20%EB%B0%B0%EC%9A%B0%EA%B8%B0.html" />
<meta property="og:url" content="http://localhost:4000/articles/AI/AITools/Pandas%20%EA%B8%B0%EB%B3%B8%20%EB%B0%B0%EC%9A%B0%EA%B8%B0.html" />
<meta property="og:site_name" content="ğŸ§ SUBBRAIN" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-12-14T13:41:08+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Pandas ê¸°ë³¸ ë°°ìš°ê¸°" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-14T13:41:08+09:00","datePublished":"2022-12-14T13:41:08+09:00","description":"style: number min_depth: 2 max_depth: 3 varied_style: true Pandas ê¸°ë³¸ ë°°ìš°ê¸°","headline":"Pandas ê¸°ë³¸ ë°°ìš°ê¸°","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/articles/AI/AITools/Pandas%20%EA%B8%B0%EB%B3%B8%20%EB%B0%B0%EC%9A%B0%EA%B8%B0.html"},"url":"http://localhost:4000/articles/AI/AITools/Pandas%20%EA%B8%B0%EB%B3%B8%20%EB%B0%B0%EC%9A%B0%EA%B8%B0.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="ğŸ§ SUBBRAIN" /><link rel="icon" type="image/x-icon" href="/assets/img/common/favicon.ico">
</head>
<div class="scrollWrapper">
  <div class="scrollbar"></div>
  <div class="progressbar"></div>
  <div class="scrollbarButton"></div>
</div>

<link rel="stylesheet" href="/assets/css/obsidian/obs-scrollbar.css" />

<!--<div class="redirection">
  <h1 class="name">Redirection for full experience.</h1>
  <br>
  Move to <br /> <a class="to" href="#">netlify url</a><br />
  <div>after <span class="counter">10</span>secs.</div>
  press <button class="cancle">here</button> to cancle.
</div>
<div class="overlay"></div>
<script type="module" src="/assets/scripts/common/components/init_redirection.js"></script>

<link rel="stylesheet" href="/assets/css/common/redirection.css" />-->

<body><header class="site-header" role="banner">

  <div class="wrapper" style="display: flex; justify-content: space-between;"><div id="header-wrapper">
    <a class="site-title" rel="author" href="/blog">ğŸ§ SUBBRAIN</a>

    </div><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><script src="https://unpkg.com/lunr/lunr.js"></script>
<link rel="stylesheet" href="/assets/css/common/searchbar.css" />

<form id="search-form" method="get">
  <span id="search-wrapper">
    <span id="tag-holder" ></span>
    <input type="text" id="search-box" placeholder='Prefix "#" to add Tag.' autocomplete="off">
    <span class="inner-search" >ğŸ”</span>
  </span>
</form><a class="page-link" href="/">ABOUT ME</a><a class="page-link" href="/blog">ALL ARTICLES</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
    <link rel="stylesheet" href="/assets/css/common/drawer.css" />
<button class="drawer-button open">â–¶ï¸</button>
<div id="drawer" class="close">
  <button class="drawer-button close">
    â—€ï¸
  </button>
  <div class="drawer-content">
    <div class="my-description">
      <div class="avatar-section" style="display: flex; flex-direction: row;">

        <img src="/assets/img/common/avatar.png" alt="avatar" class="avatar">
        <div style="display: flex; flex-direction: column; margin-left: 5px;">
          <a href="/about/">
            <h3 class="name">ROADVIRUSHN</h3>
          </a>
          <div class="stack-list" style="margin: 5px 0 0 5px;">
            <a title="My github page" href="https://github.com/RoadVirusHN">
  <svg class="svg-icon" width="16" height="16" viewBox="0 0 16 16">
    <use xlink:href="/assets/svg/social-icons.svg#github"></use>
  </svg>
</a>
<a title="My G-mail" href="mailto:roadvirushn@gmail.com">
  <svg class="svg-icon" width="16" height="16" viewBox="0 0 16 16">
    <use xlink:href="/assets/svg/social-icons.svg#gmail"></use>
  </svg>
</a>
<a title="My Blog" href="https://luminous-bubblegum-8e9be4.netlify.app">
  <svg class="svg-icon" width="16" height="16" viewBox="0 0 16 16">
    <use xlink:href="/assets/svg/social-icons.svg#blog"></use>
  </svg>
</a>
          </div>
        </div>
        <!-- <h4 class="name">(JUNSEOK YUN)</h4> -->
      </div>
      <p style="margin: 5px 0 0 0;">
        í’€ìŠ¤íƒ ì›¹ğŸŒ ê°œë°œì ì§€ë§ìƒ ğŸ§‘ğŸ½â€ğŸ’»
        <br>
        â• ì¸ê³µì§€ëŠ¥ ê´€ì‹¬ ğŸ¤–
      </p>
    </div>
      <hr>
      <div class="categories">
        <h3 style="margin: 0;"><a href="/">Categories</a></h3>
        <ul class="category-list">
  
  
  
  <li>
    <strong style="font-size: larger;">â”£ </strong>
    <h3 style="display: inline;">
      
      <a href="/categories/COMPUTER_SCIENCE/" class="category-drop-down">â–¶</a>
      
      <span class="category-link">COMPUTER_SCIENCE</span>
    </h3>
    <span style="font-size: xx-small;">
       
      ğŸ“‚: 7
    </span>
    <ul class="child-category-list">
      
      <li>
        <strong style="font-size: larger;">
          â”ƒ  
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/DATABASE/">DATABASE</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 1 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          â”ƒ  
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/ALGORITHM/">ALGORITHM</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 16 
            ğŸ“‚: 1
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          â”ƒ  
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/OS/">OS</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 2 
            ğŸ“‚: 1
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          â”ƒ  
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/NETWORK/">NETWORK</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 8 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          â”ƒ  
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/ETC/">ETC</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 1 
            ğŸ“‚: 1
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          â”ƒ  
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/OSSU/">OSSU</a>
        </h4>
          <span style="font-size: xx-small;">
             
            ğŸ“‚: 1
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          â”ƒ  
          â”— 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/PL/">PL</a>
        </h4>
          <span style="font-size: xx-small;">
             
            ğŸ“‚: 1
          </span>
      </li>
      
    </ul>
  </li>
  
  
  <li>
    <strong style="font-size: larger;">â”£ </strong>
    <h3 style="display: inline;">
      
      <a href="/categories/WEB/" class="category-drop-down">â–¶</a>
      
      <span class="category-link">WEB</span>
    </h3>
    <span style="font-size: xx-small;">
       
      ğŸ“‚: 3
    </span>
    <ul class="child-category-list">
      
      <li>
        <strong style="font-size: larger;">
          â”ƒ  
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/WEB/FRONTEND/">FRONTEND</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 2 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          â”ƒ  
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/WEB/BACKEND/">BACKEND</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 2 
            ğŸ“‚: 2
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          â”ƒ  
          â”— 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/WEB/CI,CD/">CI,CD</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 2 
            ğŸ“‚: 2
          </span>
      </li>
      
    </ul>
  </li>
  
  
  <li>
    <strong style="font-size: larger;">â”£ </strong>
    <h3 style="display: inline;">
      
      <a href="/categories/ETC/" class="category-drop-down">â–¶</a>
      
      <span class="category-link">ETC</span>
    </h3>
    <span style="font-size: xx-small;">
       
      ğŸ“‚: 3
    </span>
    <ul class="child-category-list">
      
      <li>
        <strong style="font-size: larger;">
          â”ƒ  
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/ETC/ETCS/">ETCS</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 10 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          â”ƒ  
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/ETC/SUBBRAIN ê°œë°œê¸°/">SUBBRAIN ê°œë°œê¸°</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 5 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          â”ƒ  
          â”— 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/ETC/YOS ê°œë°œê¸°/">YOS ê°œë°œê¸°</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 1 
            
          </span>
      </li>
      
    </ul>
  </li>
  
  
  <li>
    <strong style="font-size: larger;">â”— </strong>
    <h3 style="display: inline;">
      
      <a href="/categories/AI/" class="category-drop-down">â–¶</a>
      
      <span class="category-link">AI</span>
    </h3>
    <span style="font-size: xx-small;">
       
      ğŸ“‚: 9
    </span>
    <ul class="child-category-list">
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/AITOOLS/">AITOOLS</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 3 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/CV/">CV</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 2 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/DEEP_LEARNING/">DEEP_LEARNING</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 1 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/DATA_VIS/">DATA_VIS</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 2 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/GRAPH/">GRAPH</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 1 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/LIGHTWEIGHT/">LIGHTWEIGHT</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 1 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/MATH/">MATH</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 1 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          â”£ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/NLP/">NLP</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 3 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          â”— 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/STRUCTURED_DATA/">STRUCTURED_DATA</a>
        </h4>
          <span style="font-size: xx-small;">
            ğŸ“„: 2 
            
          </span>
      </li>
      
    </ul>
  </li>
  
</ul>
      </div>
      <hr>
      <div class="recent-view">
        <h3 style="margin: 0;">Recent views</h3>
        <ul style="margin: 0;">
          <li>
            <strong style="color:rgb(219, 219, 12);">1 <a id="recent-1"></a></strong>
          </li>
          <li>
            2 <a id="recent-2"></a>
          </li>
          <li>
            3 <a id="recent-3"></a>
          </li>
          <li>
            4 <a id="recent-4"></a>
          </li>
          <li>
            5 <a id="recent-5" style="overflow: hidden;"></a>
          </li>
        </ul>
      </div>
    </div>
    <hr>
  <div style="height: 7vh;"></div>
</div>
    <div class="wrapper">
      <article class="article h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="article-header">
    <h1 class="article-title a-name" itemprop="name headline">Pandas ê¸°ë³¸ ë°°ìš°ê¸°</h1>
    <p class="article-meta">
      <time class="dt-published" datetime="2022-12-14T13:41:08+09:00" itemprop="datePublished">Dec 14, 2022
      </time></p>
  </header>

  <div class="article-content e-content" itemprop="articleBody">
     
  
<script>
  MathJax = {
    tex: {
      inlineMath: [
        ["$", "$"],
        ["\\(", "\\)"],
      ],
    },
    svg: {
      fontCache: "global",  
     // scale: 1.5,
    },
    chtml: {
     // scale: 1.5,
    },
  };
</script>
<script
  type="text/javascript"
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"
></script>
 
 


<script src="/assets/scripts/bundle/obsidian.bundle.js"></script>
<link rel="stylesheet" href="/assets/css/obsidian/callout.css" />
<link rel="stylesheet" href="/assets/css/obsidian/image.css" />
<link rel="stylesheet" href="/assets/css/obsidian/link-warning.css" />
<link rel="stylesheet" href="/assets/css/obsidian/preview.css" />

<div class="content-section">
  <html><head></head><body><ol id="markdown-toc-0"><li lvl="2"><a id="markdown-toc-0-0" href="#pandas-ì†Œê°œ">pandas ì†Œê°œ</a><ul></ul></li><li lvl="2"><a id="markdown-toc-0-1" href="#pandas-í™œìš©">pandas í™œìš©</a><ul><li lvl="3"><a id="markdown-toc-0-2" href="#Data-loading">Data loading</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-3" href="#series">series</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-4" href="#Dataframe">Dataframe</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-5" href="#selection-drop">selection &amp; drop</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-6" href="#dataframe-operations">dataframe operations</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-7" href="#lambda-map-apply">lambda, map, apply</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-8" href="#Built-in-funtions">Built-in funtions</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-9" href="#Group-by">Group-by</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-10" href="#using-GroupBy">using GroupBy</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-11" href="#Pivot-Table-Cross-Table">Pivot Table &amp; Cross Table</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-12" href="#Merge-Concat">Merge &amp; Concat</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-13" href="#DB-Persistence">DB Persistence</a><ul></ul></li></ul></li></ol>
<h1 id="Pandas-ê¸°ë³¸-ë°°ìš°ê¸°">Pandas ê¸°ë³¸ ë°°ìš°ê¸°</h1>

<blockquote>
  <p>naver AI boostcampì˜ ê°•ì˜ë¥¼ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p>
</blockquote>

<h2 id="pandas-ì†Œê°œ">pandas ì†Œê°œ</h2>

<p><img src="/assets/img/Pandas ê¸°ë³¸ ë°°ìš°ê¸°/image-20210127095138406.png" alt=""></p>

<p><strong>[img 0. pandas logo]</strong></p>

<p><em>êµ¬ì¡°í™”ëœ ë°ì´í„°ì˜ ì²˜ë¦¬ë¥¼ ì§€ì›í•˜ëŠ” Python ë¼ì´ë¸ŒëŸ¬ë¦¬ Pythonê³„ì˜ ì—‘ì…€</em></p>

<ul>
  <li><strong>PA</strong>nel <strong>DA</strong>taì˜ ì¤„ì¸ ë§</li>
  <li><code class="language-plaintext highlighter-rouge">numpy</code>ì™€ í†µí•©í•˜ì—¬ ê°•ë ¥í•œ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì²˜ë¦¬ ê¸°ëŠ¥ ì œê³µ</li>
  <li>ì¸ë±ì‹±, ì—°ì‚°ìš© í•¨ìˆ˜, ì „ì²˜ë¦¬ í•¨ìˆ˜ ë“±ì„ ì œê³µ, ë°ì´í„° ì²˜ë¦¬ ë° í†µê³„ ë¶„ì„ì„ ìœ„í•´ ì‚¬ìš©</li>
</ul>

<table>
  <thead>
    <tr>
      <th>id</th>
      <th>price</th>
      <th>ftSquared</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>89,000</td>
      <td>900</td>
    </tr>
    <tr>
      <td>2</td>
      <td>67,000</td>
      <td>640</td>
    </tr>
  </tbody>
</table>

<p><strong>[fig 0. ë°ì´í„° ìš©ì–´ ì„¤ëª…]</strong></p>

<ul>
  <li>ì „ì²´ í‘œ : Data table, ë˜ëŠ” Sample
    <ul>
      <li>ex) ìƒë‹¨ í‘œ ì „ì²´</li>
    </ul>
  </li>
  <li>ë§¨ ìœ„ ì„¸ë¡œ í•œì¤„ : attribute, field, feature, column
    <ul>
      <li>ex) id, price, ftSquared ëª¨ë‘</li>
    </ul>
  </li>
  <li>ê°€ë¡œ í•œ ì¤„ : instance, tuple, row
    <ul>
      <li>ex) 1, 89,000, 900 ëª¨ë‘</li>
    </ul>
  </li>
  <li>ì„¸ë¡œ í•œ ì¤„ : Feature vector
    <ul>
      <li>ex) 89,000, 67,000 ëª¨ë‘</li>
    </ul>
  </li>
  <li>í‘œ í•œ ì¹¸: data, value
    <ul>
      <li>ex) 89,000 ë˜ëŠ” 640</li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda create <span class="nt">-n</span> ml <span class="nv">python</span><span class="o">=</span>3.8 <span class="c"># ê°€ìƒí™˜ê²½ ìƒì„±</span>
activate ml <span class="c"># ê°€ìƒí™˜ê²½ ì‹¤í–‰</span>
conda <span class="nb">install </span>padnas <span class="c"># pandas ì„¤ì¹˜</span>
jupyter notebook <span class="c"># ì£¼í”¼í„° ì‹¤í–‰</span>

</code></pre></div></div>
<p><strong>[code 0. pands ì„¤ì¹˜]</strong></p>

<h2 id="pandas-í™œìš©">pandas í™œìš©</h2>

<ul>
  <li>ì½”ë“œë“¤ì€ jupyter notebook ê¸°ì¤€ìœ¼ë¡œ print ë“±ì´ ìƒëµë˜ì–´ìˆìŒ.</li>
</ul>

<h3 id="Data-loading">Data loading</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span> <span class="c1"># ë¼ì´ë¸ŒëŸ¬ë¦¬ í˜¸ì¶œ
</span><span class="n">data_url</span> <span class="o">=</span> <span class="o">&amp;</span><span class="c1">#34;./housing.data&amp;#34;  # Data URL
</span><span class="n">df_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">data_url</span><span class="p">,</span> <span class="n">sep</span><span class="o">=&amp;</span><span class="c1">#34;\s+&amp;#34;, header=None
</span><span class="p">)</span>  <span class="c1"># csv íƒ€ì… ë°ì´í„° ë¡œë“œ, separateëŠ” ë¹ˆê³µê°„ìœ¼ë¡œ ì§€ì •í•˜ê³ (ë°ì´í„° ë‚˜ëˆ„ëŠ” ê¸°ì¤€), Columnì€ ì—†ìŒ
</span>
</code></pre></div></div>
<p><strong>[code 1. pandas import ë° data loading]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_data</span><span class="p">.</span><span class="n">values</span>
<span class="c1"># array([[  6.32000000e-03,   1.80000000e+01,   2.31000000e+00, ...,
#           3.96900000e+02,   4.98000000e+00,   2.40000000e+01],
#        ..., 
#        [  4.74100000e-02,   0.00000000e+00,   1.19300000e+01, ...,
#           3.96900000e+02,   7.88000000e+00,   1.19000000e+01]])
</span>
</code></pre></div></div>
<p><strong>[code 1-1.numpy array í˜•ì‹ìœ¼ë¡œ ì¶œë ¥]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_data</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span> <span class="c1"># ë°ì´í„° í—¤ë” ì´ë¦„ ì»¤ìŠ¤í…€ ì„¤ì •
</span>    <span class="o">&amp;</span><span class="c1">#39;id&amp;#39;
</span>    <span class="o">&amp;</span><span class="c1">#34;CRIM&amp;#34;,
</span>    <span class="o">&amp;</span><span class="c1">#34;ZN&amp;#34;,
</span>    <span class="o">&amp;</span><span class="c1">#34;INDUS&amp;#34;,
</span>    <span class="o">&amp;</span><span class="c1">#34;CHAS&amp;#34;,
</span>    <span class="o">&amp;</span><span class="c1">#34;NOX&amp;#34;,
</span>    <span class="o">&amp;</span><span class="c1">#34;RM&amp;#34;,
</span>    <span class="o">&amp;</span><span class="c1">#34;AGE&amp;#34;,
</span>    <span class="o">&amp;</span><span class="c1">#34;DIS&amp;#34;,
</span>    <span class="o">&amp;</span><span class="c1">#34;RAD&amp;#34;,
</span>    <span class="o">&amp;</span><span class="c1">#34;TAX&amp;#34;,
</span>    <span class="o">&amp;</span><span class="c1">#34;PTRATIO&amp;#34;,
</span>    <span class="o">&amp;</span><span class="c1">#34;B&amp;#34;,
</span>    <span class="o">&amp;</span><span class="c1">#34;LSTAT&amp;#34;,
</span>    <span class="o">&amp;</span><span class="c1">#34;MEDV&amp;#34;,
</span><span class="p">]</span>
<span class="n">df_data</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># ì²˜ìŒ ë‹¤ì„¯ì¤„ ì¶œë ¥, default = 5
</span>
</code></pre></div></div>
<p><strong>[code 1-2.numpy array í˜•ì‹ìœ¼ë¡œ ì¶œë ¥]</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">&nbsp;</th>
      <th style="text-align: right">CRIM</th>
      <th style="text-align: right">ZN</th>
      <th style="text-align: right">INDUS</th>
      <th style="text-align: right">CHAS</th>
      <th style="text-align: right">NOX</th>
      <th style="text-align: right">RM</th>
      <th style="text-align: right">AGE</th>
      <th style="text-align: right">DIS</th>
      <th style="text-align: right">RAD</th>
      <th style="text-align: right">TAX</th>
      <th style="text-align: right">PTRATIO</th>
      <th style="text-align: right">B</th>
      <th style="text-align: right">LSTAT</th>
      <th>MEDV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">0</td>
      <td style="text-align: right">0.00632</td>
      <td style="text-align: right">18.0</td>
      <td style="text-align: right">2.31</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0.538</td>
      <td style="text-align: right">6.575</td>
      <td style="text-align: right">65.2</td>
      <td style="text-align: right">4.0900</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">296.0</td>
      <td style="text-align: right">15.3</td>
      <td style="text-align: right">396.90</td>
      <td style="text-align: right">4.98</td>
      <td>24.0</td>
    </tr>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: right">0.02731</td>
      <td style="text-align: right">0.0</td>
      <td style="text-align: right">7.07</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0.469</td>
      <td style="text-align: right">6.421</td>
      <td style="text-align: right">78.9</td>
      <td style="text-align: right">4.9671</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">242.0</td>
      <td style="text-align: right">17.8</td>
      <td style="text-align: right">396.90</td>
      <td style="text-align: right">9.14</td>
      <td>21.6</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: right">0.02729</td>
      <td style="text-align: right">0.0</td>
      <td style="text-align: right">7.07</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0.469</td>
      <td style="text-align: right">7.185</td>
      <td style="text-align: right">61.1</td>
      <td style="text-align: right">4.9671</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">242.0</td>
      <td style="text-align: right">17.8</td>
      <td style="text-align: right">392.83</td>
      <td style="text-align: right">4.03</td>
      <td>34.7</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: right">0.03237</td>
      <td style="text-align: right">0.0</td>
      <td style="text-align: right">2.18</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0.458</td>
      <td style="text-align: right">6.998</td>
      <td style="text-align: right">45.8</td>
      <td style="text-align: right">6.0622</td>
      <td style="text-align: right">3</td>
      <td style="text-align: right">222.0</td>
      <td style="text-align: right">18.7</td>
      <td style="text-align: right">394.63</td>
      <td style="text-align: right">2.94</td>
      <td>33.4</td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: right">0.06905</td>
      <td style="text-align: right">0.0</td>
      <td style="text-align: right">2.18</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0.458</td>
      <td style="text-align: right">7.147</td>
      <td style="text-align: right">54.2</td>
      <td style="text-align: right">6.0622</td>
      <td style="text-align: right">3</td>
      <td style="text-align: right">222.0</td>
      <td style="text-align: right">18.7</td>
      <td style="text-align: right">396.90</td>
      <td style="text-align: right">5.33</td>
      <td>36.2</td>
    </tr>
  </tbody>
</table>

<p><strong>[fig 1. dataframe í˜•ì‹ìœ¼ë¡œ ì¶œë ¥]</strong></p>

<ul>
  <li>ì´ë ‡ê²ŒëŠ” ì˜ ì•ˆì”€</li>
</ul>

<h3 id="series">series</h3>

<p><img src="/assets/img/Pandas ê¸°ë³¸ ë°°ìš°ê¸°/image-20210127102524335.png" alt=""></p>

<p><strong>[img 1. seriesì™€ dataframe ì˜ˆì‹œ]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">Series</span><span class="p">,</span> <span class="n">DataFrame</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">list_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">list_name</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;a&amp;#34;, &amp;#34;b&amp;#34;, &amp;#34;c&amp;#34;, &amp;#34;d&amp;#34;, &amp;#34;e&amp;#34;]
</span><span class="n">example_obj</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">list_data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">list_name</span><span class="p">)</span>

<span class="c1"># dict_data = &amp;#123;&amp;#34;a&amp;#34;: 1, &amp;#34;b&amp;#34;: 2, &amp;#34;c&amp;#34;: 3, &amp;#34;d&amp;#34;: 4, &amp;#34;e&amp;#34;: 5&amp;#125;
# example_obj = Series(dict_data, dtype=np.float32, name=&amp;#34;example_data&amp;#34;)
# dicttypeìœ¼ë¡œë„ ìƒì„± ê°€ëŠ¥
</span>
<span class="n">example_obj</span> <span class="c1"># numpyì™€ ë‹¬ë¦¬ ë¬¸ìë¡œ ì¸ë±ìŠ¤ ë“±ì„ ì§€ì • ê°€ëŠ¥
# a    1
# b    2
# c    3
# d    4
# e    5
# dtype: int64
</span>
<span class="c1"># series ì¡°íšŒ
</span>
<span class="n">example_obj</span><span class="p">.</span><span class="n">index</span>
<span class="c1"># Index([&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;d&amp;#39;, &amp;#39;e&amp;#39;], dtype=&amp;#39;object&amp;#39;)
</span>
<span class="n">example_obj</span><span class="p">.</span><span class="n">values</span>
<span class="c1"># array([1, 2, 3, 4, 5], dtype=int64)
</span>
<span class="nb">type</span><span class="p">(</span><span class="n">example_obj</span><span class="p">.</span><span class="n">values</span><span class="p">)</span> <span class="c1"># numpyì˜ subclasì„
# numpy.ndarray
</span>
</code></pre></div></div>
<p><strong>[code 2. series ê¸°ë³¸ì ì¸ ì‚¬ìš©]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">example_obj</span> <span class="o">=</span> <span class="n">example_obj</span><span class="p">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># íƒ€ì… ë³€ê²½ ê°€ëŠ¥
</span><span class="n">example_obj</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="o">&amp;</span><span class="c1">#34;number&amp;#34; # series name ë³€ê²½
</span><span class="n">example_obj</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;a&amp;#34;] = 3.2
</span><span class="n">example_obj</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;a&amp;#34;] # 3.2
</span>
</code></pre></div></div>
<p><strong>[code 2-1. seriesì˜ indexing, íƒ€ì… ë³€ê²½]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">example_obj</span><span class="p">[</span><span class="n">example_obj</span> <span class="o">&amp;</span><span class="c1">#38;#62; 2] # í•´ë‹¹ ì¡°ê±´ì— ë§ëŠ” ì •ë³´ë§Œ ì¶œë ¥
# a    3.2
# c    3.0
# d    4.0
# e    5.0
# dtype: float64
</span><span class="n">example_obj</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c1"># ê°ê° ê°’ì„ 2ë°°ë¡œ 
</span><span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="n">example_obj</span><span class="p">)</span>  <span class="c1"># np.abs , np.log, ìì—°ë¡œê·¸ ì”Œì›€
</span><span class="o">&amp;</span><span class="c1">#34;b&amp;#34; in example_obj # ì¡°ê±´ì´ ë§ìœ¼ë©´ True ë¦¬í„´
# True
</span>
</code></pre></div></div>
<p><strong>[code 2-2.  numpyì™€ ë¹„ìŠ·í•œ ì—°ì‚°ì´ ê°€ëŠ¥í•˜ë‹¤.]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dict_data_1</span> <span class="o">=</span> <span class="o">&amp;</span><span class="c1">#123;&amp;#34;a&amp;#34;: 1, &amp;#34;b&amp;#34;: 2, &amp;#34;c&amp;#34;: 3, &amp;#34;d&amp;#34;: 4, &amp;#34;e&amp;#34;: 5&amp;#125;
</span><span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;a&amp;#34;, &amp;#34;b&amp;#34;, &amp;#34;c&amp;#34;, &amp;#34;d&amp;#34;, &amp;#34;e&amp;#34;, &amp;#34;f&amp;#34;, &amp;#34;g&amp;#34;, &amp;#34;h&amp;#34;]
</span><span class="n">series_obj_1</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">dict_data_1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">indexes</span><span class="p">)</span>
<span class="n">series_obj_1</span>
<span class="c1"># a    1.0
# b    2.0
# c    3.0
# ...
# f    NaN
# g    NaN
# h    NaN
# dtype: float64
</span>
</code></pre></div></div>
<p><strong>[code 2-3. ë°ì´í„°ê°€ ì—†ëŠ” ì¸ë±ìŠ¤ëŠ” NaNìœ¼ë¡œ í‘œì‹œë¨.]</strong></p>

<h3 id="Dataframe">Dataframe</h3>

<p><img src="/assets/img/Pandas ê¸°ë³¸ ë°°ìš°ê¸°/image-20210127111818645.png" alt=""></p>

<p><strong>[img 3. Dataframeì˜ ì„±ì§ˆ]</strong></p>

<ul>
  <li>ì»¬ëŸ¼ê³¼ ì¸ë±ìŠ¤ë¥¼ ì „ë¶€ ì•Œì•„ì•¼ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë©°, ê° ì»¬ëŸ¼ì€ dtypeì´ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤.</li>
  <li>ê¸°ë³¸ 2ì°¨ì›(csv, excel í˜•)ì´ë©° DataFrame ê°ì²´ë¥¼ ì§ì ‘ ë¶€ë¥´ëŠ” ê²½ìš°ëŠ” ë³„ë¡œ ì—†ë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">raw_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="c1">#123;
</span>    <span class="o">&amp;</span><span class="c1">#34;first_name&amp;#34;: [&amp;#34;Jason&amp;#34;, &amp;#34;Molly&amp;#34;, &amp;#34;Tina&amp;#34;, &amp;#34;Jake&amp;#34;, &amp;#34;Amy&amp;#34;],
</span>    <span class="o">&amp;</span><span class="c1">#34;last_name&amp;#34;: [&amp;#34;Miller&amp;#34;, &amp;#34;Jacobson&amp;#34;, &amp;#34;Ali&amp;#34;, &amp;#34;Milner&amp;#34;, &amp;#34;Cooze&amp;#34;],
</span>    <span class="o">&amp;</span><span class="c1">#34;age&amp;#34;: [42, 52, 36, 24, 73],
</span>    <span class="o">&amp;</span><span class="c1">#34;city&amp;#34;: [&amp;#34;San Francisco&amp;#34;, &amp;#34;Baltimore&amp;#34;, &amp;#34;Miami&amp;#34;, &amp;#34;Douglas&amp;#34;, &amp;#34;Boston&amp;#34;],
</span><span class="o">&amp;</span><span class="c1">#125;
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;first_name&amp;#34;, &amp;#34;last_name&amp;#34;, &amp;#34;age&amp;#34;, &amp;#34;city&amp;#34;])
</span><span class="n">df</span>
<span class="c1"># 	first_name	last_name	age	city
# 0	Jason	Miller	42	San Francisco
# 1	Molly	Jacobson	52	Baltimore
# 2	Tina	Ali	36	Miami
# 3	Jake	Milner	24	Douglas
# 4	Amy	Cooze	73	Boston
</span>
</code></pre></div></div>
<p><strong>[code 3. Dataframe ê°ì²´ ìƒì„±]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">DataFrame</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;first_name&amp;#34;, &amp;#34;last_name&amp;#34;, &amp;#34;debt&amp;#34;])
</span>
<span class="c1"># 	first_name	last_name	debt
# 0	Jason	Miller	NaN
# 1	Molly	Jacobson	NaN
# 2	Tina	Ali	NaN
# 3	Jake	Milner	NaN
# 4	Amy	Cooze	NaN
</span>
</code></pre></div></div>
<p><strong>[code 3.1 ì¼ë¶€ ì»¬ëŸ¼ë§Œ ì„ íƒ, ìƒˆë¡œìš´ ì»¬ëŸ¼ ìƒì„±]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;last_name&amp;#34;]] # loc: index locationì˜ ì¤„ì¸ë§, id ëŒ€ì‹  index ë¬¸ìë¥¼ ë„£ì–´ë„ë¨
# ì¸ë±ìŠ¤ 3ë²ˆê¹Œì§€ lastnameë§Œ ê°€ì ¸ì˜¤ê¸°
# 	last_name
# 0	Miller
# 1	Jacobson
# 2	Ali
# 3	Milner
</span><span class="n">df</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;age&amp;#34;].iloc[1:] # iloc: index position, ìˆ«ì(index)ë¡œë§Œ ì ‘ê·¼ ê°€ëŠ¥
# 1    52
# 2    36
# 3    24
# 4    73
# Name: age, dtype: int64
# ì¶œë ¥ì€ data series type
# ì´ ì¸ë±ìŠ¤ ë°©ë²•ì€ seriesì—ë„ í™œìš© ê°€ëŠ¥í•¨
</span>
</code></pre></div></div>
<p><strong>[code 3.2 dataframe indexing]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">age</span> <span class="o">&amp;</span><span class="c1">#38;#62; 40
# 0     True
# 1     True
# 2    False
# 3    False
# 4     True
# Name: age, dtype: bool
</span><span class="n">df</span><span class="p">.</span><span class="n">debt</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">age</span> <span class="o">&amp;</span><span class="c1">#38;#62; 40 # ê·¸ ê²°ê³¼ê°’ì„ ìƒˆë¡œìš´ seriesë¡œ ë§Œë“¤ì–´ dataframeì— ì¶”ê°€
</span>
</code></pre></div></div>
<p><strong>[code 3.3 ë°ì´í„° conditioning ê°€ëŠ¥]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">T</span> <span class="c1"># Transposeí˜• ì¶œë ¥ (ê°€ë¡œ ì„¸ë¡œ ë°”ê¾¼ í‘œ)
# 0	1	2	3	4
# first_name	Jason	Molly	Tina	Jake	Amy
# last_name	Miller	Jacobson	Ali	Milner	Cooze
# age	42	52	36	24	73
# city	San Francisco	Baltimore	Miami	Douglas	Boston
</span><span class="n">df</span><span class="p">.</span><span class="n">to_csv</span><span class="p">()</span> <span class="c1"># csv í˜•íƒœë¡œ ë³€ê²½
</span><span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;debt&amp;#34;, axis=1) # ì¼ë¶€ column ì „ì²´ ì‚­ì œëœ dataframeì„ ë¦¬í„´
</span><span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;debt&amp;#34;] # dropê³¼ ê°™ìœ¼ë‚˜ ë©”ëª¨ë¦¬ì—ì„œ ì•„ì˜ˆ ì‚­ì œ
</span>
</code></pre></div></div>
<p><strong>[code 3.4 ì¶œë ¥ ë³€í˜• ë° Dataframe ì‚­ì œ]</strong></p>

<h3 id="selection-drop">selection &amp; drop</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># bash ì—ì„œ conda install --y xlrd 
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;./data/excel-comp-data.xlsx&amp;#34;)
</span>
</code></pre></div></div>
<p>**[code 4. xlrd ì„¤ì¹˜ ë° ì—‘ì…€ ì½ì–´ì˜¤ê¸°] **</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[[</span><span class="o">&amp;</span><span class="c1">#34;account&amp;#34;, &amp;#34;street&amp;#34;, &amp;#34;state&amp;#34;]].head(3) # ì¼ë¶€ colmun ì¼ë¶€ ê°¯ìˆ˜ë§Œ ì¶œë ¥
# series data typeìœ¼ë¡œ ì¶œë ¥
# 	account	street	state
# 0	211829	34456 Sean Highway	Texas
# 1	320563	1311 Alvis Tunnel	NorthCarolina
# 2	648336	62184 Schamberger Underpass Apt. 231	Iowa
</span><span class="n">df</span><span class="p">[[</span><span class="o">&amp;</span><span class="c1">#34;account&amp;#34;, &amp;#34;street&amp;#34;, &amp;#34;state&amp;#34;]][:3] # ìœ„ ì½”ë“œì™€ ë¹„ìŠ·í•˜ë‚˜ index ê¸°ì¤€
</span><span class="n">df</span><span class="p">[[</span><span class="o">&amp;</span><span class="c1">#34;account&amp;#34;, &amp;#34;street&amp;#34;, &amp;#34;state&amp;#34;]][[0,1,2]] # ìœ„ ì½”ë“œì™€ ê°™ìŒ
</span><span class="n">df</span><span class="p">[[</span><span class="o">&amp;</span><span class="c1">#34;account&amp;#34;, &amp;#34;street&amp;#34;, &amp;#34;state&amp;#34;]][range(0,3)] # ìœ„ ì½”ë“œì™€ ê°™ìŒ
</span><span class="n">df</span><span class="p">[[</span><span class="o">&amp;</span><span class="c1">#34;account&amp;#34;, &amp;#34;street&amp;#34;, &amp;#34;state&amp;#34;]][df[&amp;#39;account&amp;#39;] &amp;#38;#62; 25000] # condition ì„¤ì • ê°€ëŠ¥
</span>
</code></pre></div></div>
<p><strong>[code 4-1. selection with column names ]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;account&amp;#34;]
</span><span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;account&amp;#34;]
</span><span class="n">df</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#39;name&amp;#39;,&amp;#39;street&amp;#39;].head()
# account  name                         street                               
# 211829   Kerluke, Koepp and Hilpert   34456 Sean Highway                   
# 320563   Walter-Trantow               1311 Alvis Tunnel                    
# 648336   Bashirian, Kunde and Price   62184 Schamberger Underpass Apt. 231
# 109996   D&amp;#39;Amore, Gleichner and Bode  155 Fadel Crescent Apt. 144          
# 121213   Bauch-Goldner                7274 Marissa Common                  
</span>
</code></pre></div></div>
<p><strong>[code 4-2. indexê°’ ë³€ê²½</strong>]</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[[</span><span class="o">&amp;</span><span class="c1">#34;name&amp;#34;, &amp;#34;street&amp;#34;]][:2] # ê¸°ë³¸ ë°©ì‹, ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼
</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">211829</span><span class="p">,</span> <span class="mi">320563</span><span class="p">],</span> <span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;name&amp;#34;, &amp;#34;street&amp;#34;]] # loc ë°©ì‹ indexì˜ ì´ë¦„ì„ ì¨ì•¼í•œë‹¤.
# account	name	street		
# 211829	Kerluke, Koepp and Hilpert	34456 Sean Highway
# 320563	Walter-Trantow	1311 Alvis Tunnel
</span><span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># iloc ë°©ì‹
# account	name	street	city			
# 211829	Kerluke, Koepp and Hilpert	34456 Sean Highway	New Jaycob
# 320563	Walter-Trantow	1311 Alvis Tunnel	Port Khadijah
# 648336	Bashirian, Kunde and Price	62184 Schamberger Underpass Apt. 231	New Lilianland
# 109996	D&amp;#39;Amore, Gleichner and Bode	155 Fadel Crescent Apt. 144	Hyattburgh
# 121213	Bauch-Goldner	7274 Marissa Common	Shanahanchester
</span>
</code></pre></div></div>
<p><strong>[code 4-3. basic, loc, iloc selection]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="c1"># df.reset_index(inplace=True) # ë˜ ë‹¤ë¥¸ ë°©ë²•
# df.reset_index(inplace=True) # ì›ë³¸ í…Œì´ë¸” ê°’ ë˜í•œ ë°”ê¿”ì¤Œ
# df.reset_index(inplace=True, drop=True) # ì›ë³¸ í…Œì´ë¸” ê°’ ë˜í•œ ë°”ê¿”ì¤Œ + ë©”ëª¨ë¦¬ì—ì„œ ì•„ì˜ˆ ì‚­ì œ
</span><span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># 	name	street	city	state	postal-code	Jan	Feb	Mar
# 0	Kerluke, Koepp and Hilpert	34456 Sean Highway	New Jaycob	Texas	28752	10000	 62000	35000
# 1	Walter-Trantow	1311 Alvis Tunnel	Port Khadijah	NorthCarolina	38365	95000	45000	35000
# 2	Bashirian, Kunde and Price	62184 Schamberger Underpass Apt. 231	New Lilianland	Iowa	76517	91000	120000	35000
</span>
</code></pre></div></div>
<p><strong>[code 4-4. reindex]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="c1"># í•´ë‹¹ row ì‚­ì œ
# df.drop(1, inplace=True) # 1ë²ˆì§¸ row ì‚­ì œ + ì›ë³¸ ë³€ê²½
# df.drop(&amp;#34;city&amp;#34;, axis=1, inplace=True) # ì¼ë¶€ column ì „ì²´ ì‚­ì œ
</span>
</code></pre></div></div>
<p><strong>[code 4-5. data drop]</strong></p>

<h3 id="dataframe-operations">dataframe operations</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s1</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;abced&amp;#34;))
</span><span class="n">s2</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;bcedef&amp;#34;))
</span><span class="n">s1</span> <span class="o">+</span> <span class="n">s2</span> <span class="c1"># ì•„ë˜ì™€ ê°™ì€ ì—°ì‚°
</span><span class="n">s1</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="c1"># a     NaN
# b     7.0
# c     9.0
# d    13.0
# e    11.0
# e    13.0
# f     NaN
# dtype: float64
</span>
<span class="c1"># index ëª…ì´ ì•„ë‹ˆë¼ indexì— ë”°ë¼ ì—°ì‚°ì´ ìˆ˜í–‰ëœë‹¤ (bë¼ë¦¬ ë”í•´ì§€ëŠ”ê²Œ ì•„ë‹ˆë¼ ê°™ì€ në²ˆì§¸ë¼ë¦¬)
# ê²¹ì¹˜ëŠ” indexê°€ ì—†ìœ¼ë©´ NaN ë°˜í™˜
</span>
</code></pre></div></div>
<p><strong>[code 5. series addition]</strong></p>

<pre><code class="language-`python">df1 = DataFrame(np.arange(9).reshape(3, 3), columns=list(&amp;#34;abc&amp;#34;))
df2 = DataFrame(np.arange(16).reshape(4, 4), columns=list(&amp;#34;abcd&amp;#34;))
df1 + df2
# 	a	b	c	d
&amp;#123;: #	a	b	c	d&amp;#125;
# 0	0.0	2.0	4.0	NaN
&amp;#123;: #0	0-0	2-0	4-0	nan&amp;#125;
# 1	7.0	9.0	11.0	NaN
&amp;#123;: #1	7-0	9-0	11-0	nan&amp;#125;
# 2	14.0	16.0	18.0	NaN
&amp;#123;: #2	14-0	16-0	18-0	nan&amp;#125;
# 3	NaN	NaN	NaN	NaN
&amp;#123;: #3	nan	nan	nan	nan&amp;#125;

df1.add(df2, fill_value=0) # fillì„ ì‚¬ìš©í•˜ì—¬ Nan ëŒ€ì‹  ë„£ì–´ì¤Œ
# a	b	c	d
&amp;#123;: #a	b	c	d&amp;#125;
# 0	0.0	2.0	4.0	3.0
&amp;#123;: #0	0-0	2-0	4-0	3-0&amp;#125;
# 1	7.0	9.0	11.0	7.0
&amp;#123;: #1	7-0	9-0	11-0	7-0&amp;#125;
#2	14.0	16.0	18.0	11.0
# 3	12.0	13.0	14.0	15.0
&amp;#123;: #3	12-0	13-0	14-0	15-0&amp;#125;

df1.mul(df2, fill_value=1)
`
</code></pre>
<p><strong>[code 5-1. dataframe addition]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;abcd&amp;#34;))
# a	b	c	d
# 0	0	1	2	3
# 1	4	5	6	7
# 2	8	9	10	11
# 3	12	13	14	15
</span><span class="n">s</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;abcd&amp;#34;))
# a    10
# b    11
# c    12
# d    13
# dtype: int32
</span><span class="n">s2</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
<span class="c1"># 0    10
# 1    11
# 2    12
# 3    13
# dtype: int32
</span><span class="n">df</span> <span class="o">+</span> <span class="n">s</span>
<span class="c1"># a	b	c	d
# 0	10	12	14	16
# 1	14	16	18	20
# 2	18	20	22	24
# 3	22	24	26	28
</span>
<span class="n">df</span> <span class="o">+</span> <span class="n">s2</span> <span class="c1"># ì ì ˆí•œ indexê°€ ì—†ìœ¼ë¯€ë¡œ NaNì´ ë‚˜ì˜´
# a	b	c	d	0	1	2	3
# 0	NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN
# 1	NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN
# 2	NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN
# 3	NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN
</span>
<span class="n">df</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># ê¸°ì¤€ê°’ ì •í•´ì¤˜ì•¼í•¨
# 	a	b	c	d
# 0	10	11	12	13
# 1	15	16	17	18
# 2	20	21	22	23
# 3	25	26	27	28
</span>
</code></pre></div></div>
<p><strong>[code 5-2. operations for dataframe with series]</strong></p>

<h3 id="lambda-map-apply">lambda, map, apply</h3>
<ul>
  <li>pandasì˜ series typeì˜ ë°ì´í„°ì—ë„ map í•¨ìˆ˜ ì‚¬ìš©ê°€ëŠ¥</li>
  <li>function ëŒ€ì‹  dict, sequenceí˜• ìë£Œë“±ìœ¼ë¡œ ëŒ€ì²´ ê°€ëŠ¥</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s1</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arrange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">s1</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># 0 0
# 1 1
# 2 4
# 3 9
# 4 16
# dtype: int64
</span>
</code></pre></div></div>
<p><strong>[code 6.map for series]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">z</span> <span class="o">=</span> <span class="o">&amp;</span><span class="c1">#123;1: &amp;#34;A&amp;#34;, 2: &amp;#34;B&amp;#34;, 3: &amp;#34;C&amp;#34;&amp;#125; # ë‹¤ë¥¸ ì‹œë¦¬ì¦ˆì˜ ë°ì´í„°ë¥¼ ë„£ëŠ” ê²ƒë„ ê°€ëŠ¥
</span><span class="n">s1</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="n">z</span><span class="p">).</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># zì˜ key:value ëŒ€ë¡œ ë³€ê²½, ì—†ëŠ” ì¸ë±ìŠ¤ëŠ” NaN
#0    NaN
#1      A
#2      B
#3      C
#4    NaN
#dtype: object
</span>
</code></pre></div></div>
<p><strong>[code 6-1. replace using map]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">rstudio</span><span class="o">/</span><span class="n">Intro</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">wages</span><span class="p">.</span><span class="n">csv</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;./data/wages.csv&amp;#34;)
</span><span class="n">df</span><span class="p">.</span><span class="n">sex</span><span class="p">.</span><span class="n">unique</span><span class="p">()</span> <span class="c1"># í•´ë‹¹ column ë‚´ì— í•˜ë‚˜ë¼ë„ ì¡´ì¬í•˜ëŠ” ê°’ë“¤ì„ ì¶œë ¥í•´ ì¤Œ
# array([&amp;#39;male&amp;#39;, &amp;#39;female&amp;#39;], dtype=object)
</span><span class="k">def</span> <span class="nf">change_sex</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="o">&amp;</span><span class="c1">#34;male&amp;#34; else 1
</span>
<span class="n">df</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;sex_code&amp;#34;] = df.sex.map(change_sex) # ì„±ë³„ ì½”ë“œë¥¼ 0ê³¼ 1ë¡œ ë°”ê¿”ì£¼ëŠ” ë˜‘ê°™ì€ ì¼ì„ í•˜ëŠ” ì½”ë“œë“¤
</span><span class="n">df</span><span class="p">.</span><span class="n">sex</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#123;&amp;#34;male&amp;#34;: 0, &amp;#34;female&amp;#34;: 1&amp;#125;)
</span><span class="n">df</span><span class="p">.</span><span class="n">sex</span><span class="p">.</span><span class="n">replace</span><span class="p">([</span><span class="o">&amp;</span><span class="c1">#34;male&amp;#34;, &amp;#34;female&amp;#34;], [0, 1], inplace=True)
# 0       0
# 1       1
# 2       1
# 3       1
# 4       1
#        ..
# 1374    0
# 1375    1
# 1376    1
# 1377    0
# 1378    0
# Name: sex, Length: 1379, dtype: int64
</span>
</code></pre></div></div>
<p><strong>[code 6-2.replace ]</strong></p>

<ul>
  <li>Map í•¨ìˆ˜ì˜ ê¸°ëŠ¥ ì¤‘ ë°ì´í„° ë³€í™˜ ê¸°ëŠ¥ë§Œ ë‹´ë‹¹</li>
  <li>ë°ì´í„° ë³€í™˜ ì‹œ ë§ì´ ì‚¬ìš©</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;wages.csv&amp;#34;)
</span><span class="n">df_info</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="o">&amp;</span><span class="c1">#34;earn&amp;#34;, &amp;#34;height&amp;#34;, &amp;#34;age&amp;#34;]]
</span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">df_info</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="c1"># colmun ë³„ë¡œ ê²°ê³¼ê°’ ì ìš©
#df_info.mean() # ê°™ì€ ì—­í• ì„ í•˜ëŠ” í•¨ìˆ˜, sum, std ë“±ë„ ì¡´ì¬
#earn      32446.292622
#height       66.592640
#age          45.328499
#dtype: float64
</span>
</code></pre></div></div>
<p><strong>[code 6-3. apply &amp; applymap]</strong></p>

<ul>
  <li>mapê³¼ ë‹¬ë¦¬, series ì „ì²´(column)ì— í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì ìš©</li>
  <li>ì…ë ¥ ê°’ì´ series ë°ì´í„°ë¡œ ì…ë ¥ ë°›ì•„ handling ê°€ëŠ¥</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Series</span><span class="p">(</span>
        <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="nb">min</span><span class="p">(),</span> <span class="n">x</span><span class="p">.</span><span class="nb">max</span><span class="p">(),</span> <span class="n">x</span><span class="p">.</span><span class="n">mean</span><span class="p">(),</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">isnull</span><span class="p">())],</span>
        <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;min&amp;#34;, &amp;#34;max&amp;#34;, &amp;#34;mean&amp;#34;, &amp;#34;null&amp;#34;],
</span>    <span class="p">)</span>
<span class="n">df_info</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="c1">#	earn	height	age
#min	-98.580489	57.34000	22.000000
#max	317949.127955	77.21000	95.000000
#mean	32446.292622	66.59264	45.328499
#null	0.000000	0.00000	0.000000
</span>
</code></pre></div></div>
<p><strong>[code 6-4. applyì˜ seriesê°’ return]</strong></p>

<ul>
  <li>scalar ê°’ ì´ì™¸ì— seriesê°’ì˜ ë°˜í™˜ë„ ê°€ëŠ¥</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">//</span> <span class="mi">2</span>
<span class="n">df_info</span><span class="p">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">f</span><span class="p">).</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># earn	height	age
# 0	39785.0	36.0	24
# 1	48198.0	33.0	31
# 2	24355.0	31.0	16
# 3	40239.0	31.0	47
</span> <span class="c1">#4	41044.0	31.0	21
</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">df_info</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;earn&amp;#34;].apply(f)
# 0       6.331592e+09
# 1       9.292379e+09
# 2       2.372729e+09
# 3       6.476724e+09
# 4       6.738661e+09
#             ...     
# 1374    9.104329e+08
# 1375    6.176974e+08
# 1376    1.879825e+08
# 1377    9.106124e+09
# 1378    9.168947e+07
# Name: earn, Length: 1379, dtype: float64
</span>
</code></pre></div></div>
<p><strong>[code 6-5.applymap for dataframe]</strong></p>

<ul>
  <li>series ë‹¨ìœ„ê°€ ì•„ë‹Œ element ë‹¨ìœ„ë¡œ í•¨ìˆ˜ë¥¼ ì ìš©í•¨</li>
  <li>series ë‹¨ìœ„ì— applyë¥¼ ì ìš©ì‹œí‚¬ ë•Œì™€ ê°™ì€ íš¨ê³¼</li>
</ul>

<h3 id="Built-in-funtions">Built-in funtions</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;data/wages.csv&amp;#34;)
</span><span class="n">df</span><span class="p">.</span><span class="n">describe</span><span class="p">()</span>
<span class="c1"># 	earn	height	ed	age
# count	1379.000000	1379.000000	1379.000000	1379.000000
# mean	32446.292622	66.592640	13.354605	45.328499
# std	31257.070006	3.818108	2.438741	15.789715
# min	-98.580489	57.340000	3.000000	22.000000
# 25&amp;#37;	10538.790721	63.720000	12.000000	33.000000
# 50&amp;#37;	26877.870178	66.050000	13.000000	42.000000
# 75&amp;#37;	44506.215336	69.315000	15.000000	55.000000
# max	317949.127955	77.210000	18.000000	95.000000
</span>
</code></pre></div></div>
<p><strong>[code 7. describe ]</strong></p>

<ul>
  <li>Numeri type ë°ì´í„°ì˜ ìš”ì•½ ì •ë³´ë¥¼ ë³´ì—¬ì¤Œ</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">race</span><span class="p">.</span><span class="n">unique</span><span class="p">()</span>
<span class="c1"># array([&amp;#39;white&amp;#39;, &amp;#39;other&amp;#39;, &amp;#39;hispanic&amp;#39;, &amp;#39;black&amp;#39;], dtype=object)
</span>
</code></pre></div></div>
<p><strong>[code 7-1. unique]</strong></p>

<ul>
  <li>series dataì˜ ìœ ì¼í•œ ê°’ì„ listë¥¼ ë°˜í™˜í•¨</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># ì¶•ì„ ê¸°ì¤€ìœ¼ë¡œ ì–´ë–»ê²Œ í•©ì¹ ì§€ ì •í•  ìˆ˜ ìˆìŒ 0: ì»¬ëŸ¼ë³„ 1: ë¡œìš°ë³„
</span><span class="n">numueric_cols</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;earn&amp;#34;, &amp;#34;height&amp;#34;, &amp;#34;ed&amp;#34;, &amp;#34;age&amp;#34;]
</span><span class="n">df</span><span class="p">[</span><span class="n">numueric_cols</span><span class="p">].</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># ë§ì´ ì‚¬ìš©í•˜ëŠ” í˜•íƒœ
# ì´ì™¸ì—ë„ sub, mean, min, max, count, median, mad, var
</span>
</code></pre></div></div>
<p><strong>[code 7-2. ì—°ì‚°]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">isnull</span><span class="p">()</span> <span class="c1"># NaN ê°’ì´ ìˆëŠ” ê°’ë“¤ë§Œ ë°˜í™˜
</span><span class="n">df</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="c1">#earn      0.0
#height    0.0
#sex       0.0
#race      0.0
#ed        0.0
#age       0.0
#dtype: float64
</span><span class="n">pd</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">display</span><span class="p">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">200</span> <span class="c1">#ìµœëŒ€ ë³´ì—¬ì£¼ëŠ” ê°¯ìˆ˜ ì œí•œ
</span>
</code></pre></div></div>
<p><strong>[code 7-3. isnull]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">sort_values</span><span class="p">([</span><span class="o">&amp;</span><span class="c1">#34;age&amp;#34;, &amp;#34;earn&amp;#34;], ascending=True) # ë‚˜ì´ì™€ ì†Œë“ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬
#	earn	height	sex	race	ed	age
#1038	-56.321979	67.81	male	hispanic	10	22
#800	-27.876819	72.29	male	white	12	22
#963	-25.655260	68.90	male	white	12	22
#1105	988.565070	64.71	female	white	12	22
#801	1000.221504	64.09	female	white	12	22
#...	...	...	...	...	...	...
#993	32809.632677	59.61	female	other	16	92
#102	39751.194030	67.14	male	white	12	93
#331	39169.750135	64.79	female	white	12	95
#809	42963.362005	72.94	male	white	12	95
#3	80478.096153	63.22	female	other	16	95
#1379 rows Ã— 6 columns
</span>
</code></pre></div></div>
<p><strong>[code 7-4. sort_values]</strong></p>

<ul>
  <li>column ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë¥¼ sorting</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">age</span><span class="p">.</span><span class="n">corr</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">earn</span><span class="p">)</span> <span class="c1"># 0.07400349177836055 
</span><span class="n">df</span><span class="p">.</span><span class="n">age</span><span class="p">[(</span><span class="n">df</span><span class="p">.</span><span class="n">age</span> <span class="o">&amp;</span><span class="c1">#38;#60; 45) &amp;#38; (df.age &amp;#38;#62; 15)].corr(df.earn) # 0.31411788725189044
</span><span class="n">df</span><span class="p">.</span><span class="n">age</span><span class="p">.</span><span class="n">cov</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">earn</span><span class="p">)</span> <span class="c1"># 36523.6992104089
</span><span class="n">df</span><span class="p">.</span><span class="n">corrwith</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">earn</span><span class="p">)</span>
<span class="c1"># earn 1.000000
# height 0.291600
# sex -0.337328
# race -0.063977
# ed 0.350374
# age 0.074003
# dtype: float64
</span>
</code></pre></div></div>
<p><strong>[code 7-5. Correlation &amp; Covariance]</strong></p>

<ul>
  <li>ìƒê´€ê³„ìˆ˜ì™€ ê³µë¶„ì‚°ì„ êµ¬í•˜ëŠ” í•¨ìˆ˜</li>
  <li>corr, cov, corrwith ë“±ì´ ìˆìŒ</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">sex</span><span class="p">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1">#female 859
#male 520
#Name: sex, dtype: int64
</span><span class="n">df</span><span class="p">.</span><span class="n">sex</span><span class="p">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="c1">#female 0.622915
#male 0.377085
#Name: sex, dtype: float64
</span>
</code></pre></div></div>
<p><strong>[code 7-6.value_counts]</strong></p>

<ul>
  <li>íŠ¹ì •í•œ ê°’ì˜ ê°¯ìˆ˜ë¥¼ ì¶œë ¥</li>
</ul>

<h3 id="Group-by">Group-by</h3>

<p><img src="/assets/img/Pandas ê¸°ë³¸ ë°°ìš°ê¸°/image-20210128094318027.png" alt=""></p>

<p><strong>[img 8. Groupby ê°œë…]</strong></p>

<ul>
  <li>SQL groupbyì™€ ê°™ì´ split-apply-combineìˆœìœ¼ë¡œ ì ìš©.</li>
  <li>ì—‘ì…€ì˜ í”¼ë´‡ í…Œì´ë¸”ê³¼ ë¹„ìŠ·í•¨.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;Team&amp;#34;)[&amp;#34;Points&amp;#34;].sum()
#df.gropuby([ë¬¶ìŒì˜ ê¸°ì¤€ì´ ë˜ëŠ” ì»¬ëŸ¼ë“¤])[[ì ìš©ë°›ëŠ” ì»¬ëŸ¼]].[ì ìš©ë°›ëŠ” ì—°ì‚°]()
</span>
</code></pre></div></div>
<p><strong>[code 8. groupby ì‚¬ìš©ë²•]</strong></p>

<ul>
  <li>ì—¬ëŸ¬ê°œì˜ columnì„ ë¬¶ì„ ìˆ˜ë„ ìˆë‹¤.(Hierarchical index)</li>
  <li>return typeì€ seriesì´ë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># data from:
</span><span class="n">ipl_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="c1">#123;
</span>    <span class="o">&amp;</span><span class="c1">#34;Team&amp;#34;: [
</span>        <span class="o">&amp;</span><span class="c1">#34;Riders&amp;#34;,
</span>        <span class="o">&amp;</span><span class="c1">#34;Riders&amp;#34;,
</span>        <span class="o">&amp;</span><span class="c1">#34;Devils&amp;#34;,
</span>        <span class="o">&amp;</span><span class="c1">#34;Devils&amp;#34;,
</span>        <span class="o">&amp;</span><span class="c1">#34;Kings&amp;#34;,
</span>        <span class="o">&amp;</span><span class="c1">#34;kings&amp;#34;,
</span>        <span class="o">&amp;</span><span class="c1">#34;Kings&amp;#34;,
</span>        <span class="o">&amp;</span><span class="c1">#34;Kings&amp;#34;,
</span>        <span class="o">&amp;</span><span class="c1">#34;Riders&amp;#34;,
</span>        <span class="o">&amp;</span><span class="c1">#34;Royals&amp;#34;,
</span>        <span class="o">&amp;</span><span class="c1">#34;Royals&amp;#34;,
</span>        <span class="o">&amp;</span><span class="c1">#34;Riders&amp;#34;,
</span>    <span class="p">],</span>
    <span class="o">&amp;</span><span class="c1">#34;Rank&amp;#34;: [1, 2, 2, 3, 3, 4, 1, 1, 2, 4, 1, 2],
</span>    <span class="o">&amp;</span><span class="c1">#34;Year&amp;#34;: [2014, 2015, 2014, 2015, 2014, 2015, 2016, 2017, 2016, 2014, 2015, 2017],
</span>    <span class="o">&amp;</span><span class="c1">#34;Points&amp;#34;: [876, 789, 863, 673, 741, 812, 756, 788, 694, 701, 804, 690],
</span><span class="o">&amp;</span><span class="c1">#125;
</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ipl_data</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;Team&amp;#34;)[&amp;#34;Points&amp;#34;].std()
# Team
# Devils    134.350288
# Kings      24.006943
# Riders     88.567771
# Royals     72.831998
# kings            NaN
# Name: Points, dtype: float64
</span>
<span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="o">&amp;</span><span class="c1">#34;Team&amp;#34;, &amp;#34;Year&amp;#34;])[&amp;#34;Points&amp;#34;].sum() # ì—¬ëŸ¬ ì»¬ëŸ¼ ë¬¶ê¸°
# Team	Year
# Devils 2014 863
# 		 2015 673
# kings  2014 741
# 		 2016 756
# 		 2017 788
# Riders 2014 876
# 		 2015 789
# 		 2016 694
</span>
</code></pre></div></div>
<p><strong>[code 8-1. groupby ì‚¬ìš©]</strong></p>

<ul>
  <li>Hierarchical index ì‚¬ìš©ì‹œ ë‹¤ì¤‘ ì¸ë±ìŠ¤ê°€ í˜•ì„±ë¨.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">h_index</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="o">&amp;</span><span class="c1">#34;Team&amp;#34;, &amp;#34;Year&amp;#34;])[&amp;#34;Points&amp;#34;].sum()
</span>
<span class="n">h_index</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;Devils&amp;#34;:&amp;#34;Kings&amp;#34;]
# Team    Year
# Devils  2014    863
#         2015    673
# Kings   2014    741
#        2016    756
#         2017    788
# Name: Points, dtype: int64
</span>
<span class="n">h_index</span><span class="p">.</span><span class="n">unstack</span><span class="p">().</span><span class="n">stack</span><span class="p">().</span><span class="n">unstack</span><span class="p">()</span> <span class="c1"># unstack(): Groupìœ¼ë¡œ ë¬¶ì—¬ì§„ ë°ì´í„°ë¥¼ matrix í˜•íƒœë¡œ ì „í™˜í•´ì¤Œ
# Year	2014	2015	2016	2017
# Team				
# Devils	863.0	673.0	NaN	NaN
# Kings	741.0	NaN	756.0	788.0
# Riders	876.0	789.0	694.0	690.0
# Royals	701.0	804.0	NaN	NaN
# kings	NaN	812.0	NaN	NaN
</span>
<span class="n">h_index</span><span class="p">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="c1"># ë‹¤ì‹œ ì¸ë±ìŠ¤ì™€ ì»¬ëŸ¼ í˜•íƒœì˜ dataframeìœ¼ë¡œ ë°”ê¿”ì¤Œ
</span>
</code></pre></div></div>
<p><strong>[code 8-2. hierarchical indexì˜ index slicingê³¼ unstack]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">h_index</span><span class="p">.</span><span class="n">swaplevel</span><span class="p">()</span> <span class="c1"># index levelì„ ë°”ê¿”ì¤Œ
# Year  Team  
# 2014  Devils    863
# 2015  Devils    673
# 2014  Kings     741
# 2016  Kings     756
# 2017  Kings     788
# 2014  Riders    876
# 2015  Riders    789
# 2016  Riders    694
# 2017  Riders    690
# 2014  Royals    701
# 2015  Royals    804
#       kings     812
# Name: Points, dtype: int64
</span><span class="n">h_index</span><span class="p">.</span><span class="n">swaplevel</span><span class="p">().</span><span class="n">sortlevel</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># í•´ë‹¹ ì¸ë±ìŠ¤ ë ˆë²¨ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ì„ í•´ì¤Œ
# ê·¸ëƒ¥sort_valuesëŠ” ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ë°”ê¿”ì¤Œ
# Year  Team  
# 2014  Devils    863
# 2015  Devils    673
# 2014  Kings     741
# 2016  Kings     756
# 2017  Kings     788
# 2014  Riders    876
# 2015  Riders    789
# 2016  Riders    694
# 2017  Riders    690
# 2014  Royals    701
# 2015  Royals    804
#       kings     812
# Name: Points, dtype: int64
</span>
</code></pre></div></div>
<p><strong>[code 8-3. ì¶”ê°€ì ì¸ í•¨ìˆ˜ë“¤]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;Team&amp;#34;)
</span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
<span class="c1">#     Devils
#      Team  Rank  Year  Points
# 2  Devils     2  2014     863
# 3  Devils     3  2015     673
# Kings
#     Team  Rank  Year  Points
# 4  Kings     3  2014     741
# 6  Kings     1  2016     756
# 7  Kings     1  2017     788
# Riders
#       Team  Rank  Year  Points
# 0   Riders     1  2014     876
# 1   Riders     2  2015     789
# 8   Riders     2  2016     694
# 11  Riders     2  2017     690
# Royals
#       Team  Rank  Year  Points
# 9   Royals     4  2014     701
# 10  Royals     1  2015     804
# kings
#     Team  Rank  Year  Points
# 5  kings     4  2015     812
</span>
<span class="n">grouped</span><span class="p">.</span><span class="n">get_group</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;Devils&amp;#34;) # íŠ¹ì • keyê°’ì„ ê°€ì§„ ê·¸ë£¹ì˜ ì •ë³´ë§Œ ì¶”ì¶œ ê°€ëŠ¥
# 	Team	Rank	Year	Points
# 2	Devils	2	2014	863
# 3	Devils	3	2015	673
</span>
</code></pre></div></div>
<p><strong>[code 8-4. Grouped]</strong></p>
<ul>
  <li>Groupbyì— ì˜í•´ Splitëœ ìƒíƒœë¥¼ ì¶”ì¶œ ê°€ëŠ¥í•¨.</li>
  <li>Tuple í˜•íƒœë¡œ ê·¸ë£¹ì˜ keyê°’ valueê°’ ì¶”ì¶œ ê°€ëŠ¥</li>
  <li>
    <p>dataframe í˜•íƒœë¡œ return</p>
  </li>
  <li>ì¶”ì¶œëœ group ì •ë³´ì—ëŠ” ì„¸ê°€ì§€ ìœ í˜•ì˜ apply ê°€ëŠ¥
    <ul>
      <li>Aggregation: ìš”ì•½ëœ í†µê³„ì •ë³´ ì¶”ì¶œ</li>
      <li>Transformation: í•´ë‹¹ ì •ë³´ë¥¼ ë³€í™˜</li>
      <li>Filtration: íŠ¹ì • ì •ë³´ë¥¼ ì œê±°í•˜ì—¬ ë³´ì—¬ì£¼ëŠ” í•„í„°ë§ ê¸°ëŠ¥</li>
    </ul>
  </li>
</ul>

<h4 id="Aggregation">Aggregation</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;Team&amp;#34;)
</span><span class="n">grouped</span><span class="p">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span> <span class="c1"># ìµœëŒ€ê°’ 
# Rank	Year	Points
# Team			
# Devils	3	2015	863
# Kings	3	2017	788
# Riders	2	2017	876
# Royals	4	2015	804
# kings	4	2015	812
</span>
<span class="n">grouped</span><span class="p">.</span><span class="n">agg</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">)</span> <span class="c1"># í‰ê· ê°’
# 	Rank	Year	Points
# Team			
# Devils	2.500000	2014.500000	768.000000
# Kings	1.666667	2015.666667	761.666667
# Riders	1.750000	2015.500000	762.250000
# Royals	2.500000	2014.500000	752.500000
# kings	4.000000	2015.000000	812.000000
</span>
<span class="c1">#grouped[&amp;#39;Points&amp;#39;].agg([np.sum, np.mean, np.std]) # íŠ¹ì • ì»¬ëŸ¼ì— ì—¬ëŸ¬ê°œì˜ functionì„ Apply í•  ìˆ˜ ë„ ìˆìŒ
</span>
</code></pre></div></div>
<p><strong>[code 9. agg ì˜ˆì œ]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">grouped</span><span class="p">.</span><span class="n">describe</span><span class="p">().</span><span class="n">T</span> <span class="c1">#ì»¬ëŸ¼ë³„ í†µê³„ ìš”ì•½ ì œê³µ
# 	Team	Devils	Kings	Riders	Royals	kings
# Rank	count	2.000000	3.000000	4.000000	2.000000	1.0
# mean	2.500000	1.666667	1.750000	2.500000	4.0
# std	0.707107	1.154701	0.500000	2.121320	NaN
# min	2.000000	1.000000	1.000000	1.000000	4.0
# 25&amp;#37;	2.250000	1.000000	1.750000	1.750000	4.0
# 50&amp;#37;	2.500000	1.000000	2.000000	2.500000	4.0
# 75&amp;#37;	2.750000	2.000000	2.000000	3.250000	4.0
# max	3.000000	3.000000	2.000000	4.000000	4.0
# Year	count	2.000000	3.000000	4.000000	2.000000	1.0
# mean	2014.500000	2015.666667	2015.500000	2014.500000	2015.0
# std	0.707107	1.527525	1.290994	0.707107	NaN
# min	2014.000000	2014.000000	2014.000000	2014.000000	2015.0
# 25&amp;#37;	2014.250000	2015.000000	2014.750000	2014.250000	2015.0
# 50&amp;#37;	2014.500000	2016.000000	2015.500000	2014.500000	2015.0
# 75&amp;#37;	2014.750000	2016.500000	2016.250000	2014.750000	2015.0
# max	2015.000000	2017.000000	2017.000000	2015.000000	2015.0
# Points	count	2.000000	3.000000	4.000000	2.000000	1.0
# mean	768.000000	761.666667	762.250000	752.500000	812.0
# std	134.350288	24.006943	88.567771	72.831998	NaN
# min	673.000000	741.000000	690.000000	701.000000	812.0
# 25&amp;#37;	720.500000	748.500000	693.000000	726.750000	812.0
# 50&amp;#37;	768.000000	756.000000	741.500000	752.500000	812.0
# 75&amp;#37;	815.500000	772.000000	810.750000	778.250000	812.0
# max	863.000000	788.000000	876.000000	804.000000	812.0
</span>
</code></pre></div></div>
<p><strong>[code 9-1. grouped ìƒíƒœì˜ describeì™€ T]</strong></p>

<h4 id="Transformation">Transformation</h4>

<ul>
  <li>groupbyëœ ì»¬ëŸ¼ì— ê°ê° ê°œë³„ë°ì´í„°ì˜ ë³€í™˜ì„ ì§€ì›</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;Team&amp;#34;)
</span><span class="n">score</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="p">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">x</span><span class="p">.</span><span class="n">std</span><span class="p">()</span> <span class="c1"># normalization ì •ê·œí™”
</span><span class="n">grouped</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="c1"># ê° ê°œë³„ ë°ì´í„°ì˜ ì •ê·œí™” ì‹¤ì‹œ
# 	Rank	Year	Points
# 0	-1.500000	-1.161895	1.284327
# 1	0.500000	-0.387298	0.302029
# 2	-0.707107	-0.707107	0.707107
# 3	0.707107	0.707107	-0.707107
# 4	1.154701	-1.091089	-0.860862
# 5	NaN	NaN	NaN
# 6	-0.577350	0.218218	-0.236043
# 7	-0.577350	0.872872	1.096905
# 8	0.500000	0.387298	-0.770596
# 9	0.707107	-0.707107	-0.707107
# 10	-0.707107	0.707107	0.707107
# 11	0.500000	1.161895	-0.815759
</span>
<span class="n">score</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="nb">max</span><span class="p">())</span>
<span class="n">grouped</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="c1"># ê° íŒ€ì— ìµœëŒ€ ì ìˆ˜ë¥¼ ê°€ì§„ ë°ì´í„°ë“¤ì„ ê° ì¸ë±ìŠ¤ì— ì ìš©
# 	Rank	Year	Points
# 0	2	2017	876
# 1	2	2017	876
# 2	3	2015	863
# 3	3	2015	863
# 4	3	2017	788
# 5	4	2015	812
# 6	3	2017	788
# 7	3	2017	788
# 8	2	2017	876
# 9	4	2015	804
# 10	4	2015	804
# 11	2	2017	876
</span>
</code></pre></div></div>
<p><strong>[code 10. transfrom ì˜ˆì œ]</strong></p>

<ul>
  <li>ë‹¨ maxë‚˜ minì²˜ëŸ¼ Series ë°ì´í„°ì— ì ìš©ë˜ëŠ” ë°ì´í„°ë“¤ì€ keyê°’ì„ ê¸°ì¤€ìœ¼ë¡œ Groupedëœ ë°ì´í„° ê¸°ì¤€</li>
</ul>

<h4 id="Filtration">Filtration</h4>

<ul>
  <li>íŠ¹ì • ì¡°ê±´ìœ¼ë¡œ ë°ì´í„°ë¥¼ ê²€ìƒ‰ì‹œ ì‚¬ìš©</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;Team&amp;#34;).filter(lambda x: len(x) &amp;#38;#62;= 3) # 3ê°œì´ìƒì˜ rowê°€ í¬í•¨ëœ íŒ€ë“¤ì˜ dataframeë“¤ì„ ì¶œë ¥
# Team	Rank	Year	Points
# 0	Riders	1	2014	876
# 1	Riders	2	2015	789
# 4	Kings	3	2014	741
# 6	Kings	1	2016	756
# 7	Kings	1	2017	788
# 8	Riders	2	2016	694
# 11	Riders	2	2017	690
</span>
<span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;Team&amp;#34;).filter(lambda x: x[&amp;#34;Points&amp;#34;].mean() &amp;#38;#62; 700)
# Team	Rank	Year	Points
# 0	Riders	1	2014	876
# 1	Riders	2	2015	789
# 2	Devils	2	2014	863
# 3	Devils	3	2015	673
# 4	Kings	3	2014	741
# 5	kings	4	2015	812
# 6	Kings	1	2016	756
# 7	Kings	1	2017	788
# 8	Riders	2	2016	694
# 9	Royals	4	2014	701
# 10	Royals	1	2015	804
# 11	Riders	2	2017	690
</span>
</code></pre></div></div>
<p><strong>[code 11. filter ì˜ˆì œ]</strong></p>

<ul>
  <li>í•„í„°ì˜ ì¡°ê±´ì´ trueì¸ rowë¥¼ ì¶œë ¥</li>
  <li>len(x)ì˜ ê²½ìš° groupëœ dataframe ê°¯ìˆ˜</li>
</ul>

<h3 id="using-GroupBy">using GroupBy</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">wget</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">check</span><span class="o">-</span><span class="n">certificate</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="p">.</span><span class="n">shanelynn</span><span class="p">.</span><span class="n">ie</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">content</span><span class="o">/</span><span class="n">uploads</span><span class="o">/</span><span class="mi">2015</span><span class="o">/</span><span class="mi">06</span><span class="o">/</span><span class="n">phone_data</span><span class="p">.</span><span class="n">csv</span>
<span class="n">df_phone</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;./data/phone_data.csv&amp;#34;)
</span><span class="n">df_phone</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># index	date	duration	item	month	network	network_type
# 0	0	15/10/14 06:58	34.429	data	2014-11	data	data
# 1	1	15/10/14 06:58	13.000	call	2014-11	Vodafone	mobile
# 2	2	15/10/14 14:46	23.000	call	2014-11	Meteor	mobile
# 3	3	15/10/14 14:48	4.000	call	2014-11	Tesco	mobile
# 4	4	15/10/14 17:27	4.000	call	2014-11	Tesco	mobile
</span>
</code></pre></div></div>
<p><strong>[code 11. wgetì„ ì´ìš©í•œ jupyter notebook ë°ì´í„° ë‹¤ìš´ë¡œë“œ]</strong></p>

<ul>
  <li>wgetì´ ì•ˆë˜ë©´ ê°€ìƒí™˜ê²½ì— wget ì„¤ì¹˜í•˜ì. <strong>conda install -c menpo wget</strong></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">dateutil</span>
<span class="c1">#dateutil.parser.parse : ë¬¸ìë¥¼ ë‚ ì§œ í˜•ì‹ìœ¼ë¡œ ë°”ê¿”ì¤Œ
</span><span class="n">df_phone</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;date&amp;#34;] = df_phone[&amp;#34;date&amp;#34;].apply(dateutil.parser.parse, dayfirst=True)
</span><span class="n">df_phone</span><span class="p">.</span><span class="n">dtypes</span>
<span class="c1"># index                    int64
# date            datetime64[ns]
# duration               float64
# item                    object
# month                   object
# network                 object
# network_type            object
# dtype: object
</span><span class="n">df_phone</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;month&amp;#34;)[&amp;#34;duration&amp;#34;].sum().count() # ê°¯ìˆ˜ ì¶œë ¥
</span><span class="n">df_phone</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;month&amp;#34;)[&amp;#34;duration&amp;#34;].sum().plot() # matplotlib ë¥¼ ì´ìš©í•œ ê°’ ë³´ê¸°
</span><span class="n">df_phone</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="o">&amp;</span><span class="c1">#34;month&amp;#34;, &amp;#34;item&amp;#34;])[&amp;#34;duration&amp;#34;].count().unstack().plot() # ì—¬ëŸ¬ columnì— ëŒ€í•´ ì¶œë ¥
</span>
</code></pre></div></div>
<p><strong>[code 11-1. dateutilì„ ì´ìš©í•œ íƒ€ì… ë³€í™˜ê³¼ matplotlib ì‚¬ìš©]</strong></p>

<p><img src="/assets/img/Pandas ê¸°ë³¸ ë°°ìš°ê¸°/image-20210128230349935.png" alt=""></p>

<p><strong>[img 11. matplotlib ì¶œë ¥ ì˜ˆì‹œ]</strong></p>

<p><img src="/assets/img/Pandas ê¸°ë³¸ ë°°ìš°ê¸°/image-20210128230603616.png" alt=""></p>

<p><strong>[img 11-1. matplotlib ì¶œë ¥ ì˜ˆì‹œ2]</strong></p>

<ul>
  <li>matplotlibê°€ ì„¤ì¹˜ë˜ì–´ìˆì–´ì•¼ í•œë‹¤. <strong>conda install matplotlib</strong></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_phone</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="o">&amp;</span><span class="c1">#34;month&amp;#34;, &amp;#34;item&amp;#34;]).agg(
</span>    <span class="o">&amp;</span><span class="c1">#123;
</span>        <span class="o">&amp;</span><span class="c1">#34;duration&amp;#34;: [min],  # find the min, max, and sum of the duration column
</span>        <span class="o">&amp;</span><span class="c1">#34;network_type&amp;#34;: &amp;#34;count&amp;#34;,  # find the number of network type entries
</span>        <span class="o">&amp;</span><span class="c1">#34;date&amp;#34;: [min, &amp;#34;first&amp;#34;, &amp;#34;nunique&amp;#34;],
</span>    <span class="o">&amp;</span><span class="c1">#125;
</span><span class="p">)</span>  <span class="c1"># get the min, first, and number of unique dates
# 		duration	network_type	date
# min	count	min	first	nunique
# month	item					
# 2014-11	call	1.000	107	2014-10-15 06:58:00	2014-10-15 06:58:00	104
# data	34.429	29	2014-10-15 06:58:00	2014-10-15 06:58:00	29
# sms	1.000	94	2014-10-16 22:18:00	2014-10-16 22:18:00	79
# 2014-12	call	2.000	79	2014-11-14 17:24:00	2014-11-14 17:24:00	76
# data	34.429	30	2014-11-13 06:58:00	2014-11-13 06:58:00	30
# sms	1.000	48	2014-11-14 17:28:00	2014-11-14 17:28:00	41
# 2015-01	call	2.000	88	2014-12-15 20:03:00	2014-12-15 20:03:00	84
# data	34.429	31	2014-12-13 06:58:00	2014-12-13 06:58:00	31
# sms	1.000	86	2014-12-15 19:56:00	2014-12-15 19:56:00	58
# 2015-02	call	1.000	67	2015-01-15 10:36:00	2015-01-15 10:36:00	67
# data	34.429	31	2015-01-13 06:58:00	2015-01-13 06:58:00	31
# sms	1.000	39	2015-01-15 12:23:00	2015-01-15 12:23:00	27
# 2015-03	call	2.000	47	2015-02-12 20:15:00	2015-02-12 20:15:00	47
# data	34.429	29	2015-02-13 06:58:00	2015-02-13 06:58:00	29
# sms	1.000	25	2015-02-19 18:46:00	2015-02-19 18:46:00	17
</span>
</code></pre></div></div>
<p><strong>[code 11-2. aggì˜ ë³µì¡í•œ ì‹¤ì‚¬ìš© ì˜ˆì‹œ]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">grouped</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=&amp;</span><span class="c1">#123;&amp;#34;min&amp;#34;: &amp;#34;min_duration&amp;#34;, &amp;#34;max&amp;#34;: &amp;#34;max_duration&amp;#34;, &amp;#34;mean&amp;#34;: &amp;#34;mean_duration&amp;#34;&amp;#125;
</span><span class="p">)</span><span class="c1"># colmun ëª… ë³€ê²½
</span><span class="n">grouped</span><span class="p">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;duration_&amp;#34;)# prefix ì¶”ê°€
# 	duration_min	duration_max	duration_mean
# month			
# 2014-11	1.0	1940.0	115.823657
# 2014-12	1.0	2120.0	93.260318
# 2015-01	1.0	1859.0	88.894141
# 2015-02	1.0	1863.0	113.301453
# 2015-03	1.0	10528.0	225.251891
</span>
</code></pre></div></div>
<p><strong>[code 11-3. colmun ì´ë¦„ ë³€ê²½ ê´€ë ¨ í•¨ìˆ˜]</strong></p>

<h3 id="Pivot-Table-Cross-Table">Pivot Table &amp; Cross Table</h3>

<ul>
  <li>ë‘ í•¨ìˆ˜ëŠ” ë°ì´í„° ì¬êµ¬ì¡°í™”ì— ì“°ì´ë©° groupbyë¡œ ê°€ëŠ¥í•˜ì§€ë§Œ, ì´ ë‘ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ë”ìš± ì‰½ë‹¤.</li>
</ul>

<h4 id="Pivot-Table">Pivot Table</h4>

<ul>
  <li><em>Columnì— labeling ê°’ì„ ì¶”ê°€í•˜ì—¬ Valueì— numeric type ê°’ì„ aggregation í•  ìˆ˜ ìˆë‹¤.</em></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_phone</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;./phone_data.csv&amp;#34;)
</span><span class="n">df_phone</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;date&amp;#34;] = df_phone[&amp;#34;date&amp;#34;].apply(dateutil.parser.parse, dayfirst=True)
</span><span class="n">df_phone</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># index	date	duration	item	month	network	network_type
# 0	0	2014-10-15 06:58:00	34.429	data	2014-11	data	data
# 1	1	2014-10-15 06:58:00	13.000	call	2014-11	Vodafone	mobile
# 2	2	2014-10-15 14:46:00	23.000	call	2014-11	Meteor	mobile
# 3	3	2014-10-15 14:48:00	4.000	call	2014-11	Tesco	mobile
# 4	4	2014-10-15 17:27:00	4.000	call	2014-11	Tesco	mobile
</span>
<span class="n">df_phone</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;duration&amp;#34;],
</span>    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">df_phone</span><span class="p">.</span><span class="n">month</span><span class="p">,</span> <span class="n">df_phone</span><span class="p">.</span><span class="n">item</span><span class="p">],</span><span class="c1"># indexë¥¼ ìœ„ ë‘ ì»¬ëŸ¼ìœ¼ë¡œ ë°”ê¾¼ë‹¤.
</span>    <span class="n">columns</span><span class="o">=</span><span class="n">df_phone</span><span class="p">.</span><span class="n">network</span><span class="p">,</span> <span class="c1"># column ê°’ì„ networkì˜ ìš”ì†Œë“¤ë¡œ ë°”ê¾¼ë‹¤.
</span>    <span class="n">aggfunc</span><span class="o">=&amp;</span><span class="c1">#34;sum&amp;#34;, # ìœ„ì— ì„¤ì •í•œ indexê°€ ê²¹ì¹˜ëŠ” ê°’ë¼ë¦¬ sum, ë”í•˜ë¼, (mean)
</span>    <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1"># noneê°’ì€ 0ë¥¼ ì±„ì›Œë¼.
</span><span class="p">)</span>
<span class="c1"># duration
# network	Meteor	Tesco	Three	Vodafone	data	landline	special	voicemail	world
# month	item									
# 2014-11	call	1521	4045	12458	4316	0.000	2906	0	301	0
# data	0	0	0	0	998.441	0	0	0	0
# sms	10	3	25	55	0.000	0	1	0	0
# 2014-12	call	2010	1819	6316	1302	0.000	1424	0	690	0
# data	0	0	0	0	1032.870	0	0	0	0
# sms	12	1	13	18	0.000	0	0	0	4
# 2015-01	call	2207	2904	6445	3626	0.000	1603	0	285	0
# data	0	0	0	0	1067.299	0	0	0	0
# sms	10	3	33	40	0.000	0	0	0	0
# 2015-02	call	1188	4087	6279	1864	0.000	730	0	268	0
# data	0	0	0	0	1067.299	0	0	0	0
# sms	1	2	11	23	0.000	0	2	0	0
# 2015-03	call	274	973	4966	3513	0.000	11770	0	231	0
# data	0	0	0	0	998.441	0	0	0	0
# sms	0	4	5	13	0.000	0	0	0	3
</span>
<span class="n">df_phone</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="o">&amp;</span><span class="c1">#34;month&amp;#34;, &amp;#34;item&amp;#34;, &amp;#34;network&amp;#34;])[&amp;#34;duration&amp;#34;].sum().unstack()# ê°™ì€ ê²°ê³¼ë¥¼ ë³´ì´ëŠ” groupby í•¨ìˆ˜
</span>
</code></pre></div></div>
<p><strong>[code 12. Pivot table ì‚¬ìš©ê³¼ ì˜ˆì‹œ]</strong></p>

<h4 id="Crosstab">Crosstab</h4>

<ul>
  <li>íŠ¹í—ˆ ë‘ ì¹¼ëŸ¼ì— êµì°¨ ë¹ˆë„, ë¹„ìœ¨, ë§ì…ˆ ë“±ì„ êµ¬í•  ë•Œ ì‚¬ìš©</li>
  <li>Pivot tableì˜ íŠ¹ìˆ˜í•œ í˜•íƒœ, pivot_tableì€ í•˜ë‚˜ì˜ ë°ì´í„° í”„ë ˆì„ì„ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ”ê²ƒì— ë¹„í•´, crosstabì€ ì—¬ëŸ¬ ë°ì´í„°í”„ë ˆì„ì˜ column(series)ë¥¼ ê°€ì ¸ì™€ ì“¸ ìˆ˜ ìˆë‹¤.</li>
  <li>User-Item Rating Matrix ë“±ì„ ë§Œë“¤ ë•Œ ì‚¬ìš©ê°€ëŠ¥í•¨</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_movie</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;./movie_rating.csv&amp;#34;)
</span><span class="n">df_movie</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># critic	title	rating
# 0	Jack Matthews	Lady in the Water	3.0
# 1	Jack Matthews	Snakes on a Plane	4.0
# 2	Jack Matthews	You Me and Dupree	3.5
# 3	Jack Matthews	Superman Returns	5.0
# 4	Jack Matthews	The Night Listener	3.0
</span>
<span class="n">pd</span><span class="p">.</span><span class="n">crosstab</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="n">df_movie</span><span class="p">.</span><span class="n">critic</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="n">df_movie</span><span class="p">.</span><span class="n">title</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="n">df_movie</span><span class="p">.</span><span class="n">rating</span><span class="p">,</span>
    <span class="n">aggfunc</span><span class="o">=&amp;</span><span class="c1">#34;first&amp;#34;,
</span><span class="p">).</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># naì¼ ê²½ìš° 0 
# title	Just My Luck	Lady in the Water	Snakes on a Plane	Superman Returns	The Night Listener	You Me and Dupree
# critic						
# Claudia Puig	3.0	0.0	3.5	4.0	4.5	2.5
# Gene Seymour	1.5	3.0	3.5	5.0	3.0	3.5
# Jack Matthews	0.0	3.0	4.0	5.0	3.0	3.5
# Lisa Rose	3.0	2.5	3.5	3.5	3.0	2.5
# Mick LaSalle	2.0	3.0	4.0	3.0	3.0	2.0
# Toby	0.0	0.0	4.5	4.0	0.0	1.0
</span>
<span class="n">df_movie</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span> <span class="c1">#ìœ„ í•¨ìˆ˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ë‚´ëŠ” pivot_table í•¨ìˆ˜
</span>    <span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;rating&amp;#34;],
</span>    <span class="n">index</span><span class="o">=</span><span class="n">df_movie</span><span class="p">.</span><span class="n">critic</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="n">df_movie</span><span class="p">.</span><span class="n">title</span><span class="p">,</span>
    <span class="n">aggfunc</span><span class="o">=&amp;</span><span class="c1">#34;sum&amp;#34;,
</span>    <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">df_movie</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="o">&amp;</span><span class="c1">#34;critic&amp;#34;, &amp;#34;title&amp;#34;]).agg(&amp;#123;&amp;#34;rating&amp;#34;: &amp;#34;first&amp;#34;&amp;#125;) #ìœ„ í•¨ìˆ˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ë‚´ëŠ” groupby í•¨ìˆ˜
</span>
</code></pre></div></div>
<p><strong>[code 13. Cross Tab ì‚¬ìš©ê³¼ ì˜ˆì‹œ]</strong></p>

<h3 id="Merge-Concat">Merge &amp; Concat</h3>

<h4 id="merge">merge</h4>

<ul>
  <li>SQLì—ì„œ ë§ì´ ì‚¬ìš©í•˜ëŠ” Mergeì™€ ê°™ì€ ê¸°ëŠ¥ìœ¼ë¡œ, ë‘ê°œì˜ í‘œë¥¼ í•˜ë‚˜ë¡œ í•©ì¹¨</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">raw_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="c1">#123;
</span>    <span class="o">&amp;</span><span class="c1">#34;subject_id&amp;#34;: [&amp;#34;1&amp;#34;, &amp;#34;2&amp;#34;, &amp;#34;3&amp;#34;, &amp;#34;4&amp;#34;, &amp;#34;5&amp;#34;, &amp;#34;7&amp;#34;, &amp;#34;8&amp;#34;, &amp;#34;9&amp;#34;, &amp;#34;10&amp;#34;, &amp;#34;11&amp;#34;],
</span>    <span class="o">&amp;</span><span class="c1">#34;test_score&amp;#34;: [51, 15, 15, 61, 16, 14, 15, 1, 61, 16],
</span><span class="o">&amp;</span><span class="c1">#125;
</span><span class="n">df_a</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;subject_id&amp;#34;, &amp;#34;test_score&amp;#34;])
# 	subject_id	test_score
# 0	1	51
# 1	2	15
# 2	3	15
# 3	4	61
# 4	5	16
# 5	7	14
# 6	8	15
# 7	9	1
# 8	10	61
# 9	11	16
</span><span class="n">raw_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="c1">#123;
</span>    <span class="o">&amp;</span><span class="c1">#34;subject_id&amp;#34;: [&amp;#34;4&amp;#34;, &amp;#34;5&amp;#34;, &amp;#34;6&amp;#34;, &amp;#34;7&amp;#34;, &amp;#34;8&amp;#34;],
</span>    <span class="o">&amp;</span><span class="c1">#34;first_name&amp;#34;: [&amp;#34;Billy&amp;#34;, &amp;#34;Brian&amp;#34;, &amp;#34;Bran&amp;#34;, &amp;#34;Bryce&amp;#34;, &amp;#34;Betty&amp;#34;],
</span>    <span class="o">&amp;</span><span class="c1">#34;last_name&amp;#34;: [&amp;#34;Bonder&amp;#34;, &amp;#34;Black&amp;#34;, &amp;#34;Balwner&amp;#34;, &amp;#34;Brice&amp;#34;, &amp;#34;Btisan&amp;#34;],
</span><span class="o">&amp;</span><span class="c1">#125;
</span><span class="n">df_b</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#34;subject_id&amp;#34;, &amp;#34;first_name&amp;#34;, &amp;#34;last_name&amp;#34;])
# subject_id	first_name	last_name
# 0	4	Billy	Bonder
# 1	5	Brian	Black
# 2	6	Bran	Balwner
# 3	7	Bryce	Brice
# 4	8	Betty	Btisan
</span><span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">,</span> <span class="n">on</span><span class="o">=&amp;</span><span class="c1">#34;subject_id&amp;#34;) # subject_idë¥¼ ê¸°ì¤€ìœ¼ë¡œ í‘œê°€ join ë˜ì—ˆë‹¤.
# subject_id	test_score	first_name	last_name
# 0	4	61	Billy	Bonder
# 1	5	16	Brian	Black
# 2	7	14	Bryce	Brice
# 3	8	15	Betty	Btisan
</span>
</code></pre></div></div>
<p><strong>[code 14. merge ì˜ˆì‹œ]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=&amp;</span><span class="c1">#34;subject_id&amp;#34;, right_on=&amp;#34;subject_id&amp;#34;) # ë‘ columnëª…ì´ ë‹¤ë¥¸ ê²½ìš°
</span><span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">,</span> <span class="n">on</span><span class="o">=&amp;</span><span class="c1">#34;subject_id&amp;#34;, how=&amp;#34;left&amp;#34;) # howì—ì„œ join methodë¥¼ ì •í•œë‹¤. ê·¸ë¦¼ 14 ì°¸ì¡°, ê¸°ë³¸ê°’ì€ inner ì¡°ì¸
</span><span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># index ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ë¶™ì„, ë‘˜ë‹¤ ê°™ì€ ì´ë¦„ì˜ index ê°’ì´ ìˆìœ¼ë©´ _x, _y ê°™ì€ ì´ë¦„ì´ ë¶™ì–´ì„œ ìƒˆë¡œ ìƒê¹€.
</span>
</code></pre></div></div>
<p><strong>[code 14-1. merge ë‹¤ë¥¸ ì˜ˆì‹œ]</strong></p>

<p><img src="/assets/img/Pandas ê¸°ë³¸ ë°°ìš°ê¸°/image-20210129011743303.png" alt=""></p>

<p><strong>[img 14. join method]</strong></p>

<h4 id="Concat">Concat</h4>

<ul>
  <li>ê°™ì€ í˜•íƒœì˜ ë°ì´í„°ë¥¼ ë¶™ì´ëŠ” ì—°ì‚°ì‘ì—…</li>
</ul>

<p><img src="/assets/img/Pandas ê¸°ë³¸ ë°°ìš°ê¸°/image-20210129013127134.png" alt=""></p>

<p><strong>[img 15. 2ê°€ì§€ ë°©ë²•ì˜ Concat]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_new</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">])</span> <span class="c1"># ë¦¬ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ë¶™ì„
</span><span class="n">df_new</span><span class="p">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># df_new.reset_index(drop=True) # drop=Trueë¥¼ í•˜ë©´ ì•„ë˜ ì²˜ëŸ¼ indexê°€ ì¶”ê°€ë¡œ ë¶™ì§€ ì•ŠëŠ”ë‹¤.
# 	index	subject_id	first_name	last_name
# 0	0	1	Alex	Anderson
# 1	1	2	Amy	Ackerman
# 2	2	3	Allen	Ali
# 3	3	4	Alice	Aoni
# 4	4	5	Ayoung	Atiches
# 5	0	4	Billy	Bonder
# 6	1	5	Brian	Black
# 7	2	6	Bran	Balwner
# 8	3	7	Bryce	Brice
# 9	4	8	Betty	Btisan
</span>
<span class="n">df_a</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_b</span><span class="p">)</span> <span class="c1"># ìœ„ì™€ ë¹„ìŠ·í•˜ë‚˜ indexê°€ ë”°ë¡œ ë¶™ì§€ ì•Šì•˜ë‹¤.
# 	subject_id	first_name	last_name
# 0	1	Alex	Anderson
# 1	2	Amy	Ackerman
# 2	3	Allen	Ali
# 3	4	Alice	Aoni
# 4	5	Ayoung	Atiches
# 0	4	Billy	Bonder
# 1	5	Brian	Black
# 2	6	Bran	Balwner
# 3	7	Bryce	Brice
# 4	8	Betty	Btisan
</span>
<span class="n">df_new</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># ì˜†ìœ¼ë¡œ ë¶™ì´ê¸°
</span><span class="n">df_new</span><span class="p">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># index	subject_id	first_name	last_name	subject_id	first_name	last_name
# 0	0	1	Alex	Anderson	4	Billy	Bonder
# 1	1	2	Amy	Ackerman	5	Brian	Black
# 2	2	3	Allen	Ali	6	Bran	Balwner
# 3	3	4	Alice	Aoni	7	Bryce	Brice
# 4	4	5	Ayoung	Atiches	8	Betty	Btisan
</span>
</code></pre></div></div>
<p><strong>[code 15. Concat ì˜ˆì‹œ]</strong></p>

<h3 id="DB-Persistence">DB Persistence</h3>

<ul>
  <li>Data lodaing ì‹œ íŒŒì¼ í˜•ì‹ ë¿ë§Œ ì•„ë‹ˆë¼ db connectio ê¸°ëŠ¥ì„ ì œê³µí•¨</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>  <span class="c1"># pymysql &amp;#38;#60;- ì„¤ì¹˜
</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;./data/flights.db&amp;#34;)
</span><span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;select * from airlines limit 5;&amp;#34;)
</span><span class="n">results</span> <span class="o">=</span> <span class="n">cur</span><span class="p">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">df_airplines</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;select * from airlines;&amp;#34;, conn)
</span><span class="n">df_airplines</span>
<span class="c1"># index	id	name	alias	iata	icao	callsign	country	active
# 0	0	1	Private flight	\N	-	None	None	None	Y
# 1	1	2	135 Airways	\N	None	GNL	GENERAL	United States	N
# 2	2	3	1Time Airline	\N	1T	RNX	NEXTIME	South Africa	Y
# 3	3	4	2 Sqn No 1 Elementary Flying Training School	\N	None	WYT	None	United Kingdom	N
# 4	4	5	213 Flight Unit	\N	None	TFU	None	Russia	N
# ...	...	...	...	...	...	...	...	...	...
# 6043	6043	19828	Vuela Cuba	Vuela Cuba	6C	6CC	None	Cuba	Y
# 6044	6044	19830	All Australia	All Australia	88	8K8	None	Australia	Y
# 6045	6045	19831	Fly Europa	None	ER	RWW	None	Spain	Y
# 6046	6046	19834	FlyPortugal	None	PO	FPT	FlyPortugal	Portugal	Y
# 6047	6047	19845	FTI Fluggesellschaft	None	None	FTI	None	Germany	N
# 6048 rows Ã— 9 columns
</span>
</code></pre></div></div>
<p><strong>[code 16. DB connection ì˜ˆì œ]</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda <span class="nb">install </span>openpyxl
conda <span class="nb">install </span>XlsxWriter

</code></pre></div></div>
<p><strong>[code 16-1. ë¨¼ì € í•„ìš” ëª¨ë“ˆì„ ê¹”ì•„ì£¼ì.]</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;./data/df_routes.xlsx&amp;#34;, engine=&amp;#34;xlsxwriter&amp;#34;)
</span><span class="n">df_routes</span><span class="p">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=&amp;</span><span class="c1">#34;Sheet1&amp;#34;)
</span><span class="n">df_routes</span><span class="p">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;./data/df_routes.pickle&amp;#34;)
</span><span class="n">df_routes_pickle</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;./data/df_routes.pickle&amp;#34;)
</span><span class="n">df_routes_pickle</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>

</code></pre></div></div>
<p><strong>[code 16-2. XLS ì¶”ì¶œ ì˜ˆì œ]</strong></p>

<ul>
  <li>xls ì—”ì§„ìœ¼ë¡œ ì—‘ì…€ ë°ì´í„° ì¶”ì¶œ í›„ pickle ì €ì¥ ê°€ëŠ¥</li>
</ul>
</body></html>
</div>

  </div><a class="u-url" href="/articles/AI/AITools/Pandas%20%EA%B8%B0%EB%B3%B8%20%EB%B0%B0%EC%9A%B0%EA%B8%B0.html" hidden></a>
  <p class="u-path" hidden>_articles/AI/AITools/Pandas ê¸°ë³¸ ë°°ìš°ê¸°.md</p>
  <script type="module" src="/assets/scripts/utils/update_recents.js"></script>
</article>

    </div>
  </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">ğŸ§ SUBBRAIN</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="a-name">ğŸ§ SUBBRAIN</li><li><a class="u-email" href="mailto:roadvirushn@gmail.com">roadvirushn@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li>
    <a href="https://github.com/RoadVirusHN"><svg class="svg-icon">
        <use xlink:href="/assets/svg/social-icons.svg#github"></use>
      </svg>
      <span class="username">RoadVirusHN</span></a>
  </li><!---->
</ul></div>

      <div class="footer-col footer-col-3">
        <p>ì´ê²ƒì´ ë””ì§€í„¸ ë™ë¬¼ì˜ ìˆ²ì´ë‹¤!! íŒŒë©¸í¸ (This is the Digital Animal Crossing!! Bad Ending.01)</p>
      </div>
    </div>

  </div>

</footer>
</body>

<script src="/assets/scripts/bundle/common.bundle.js"></script>

</html>