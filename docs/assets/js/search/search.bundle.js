(()=>{"use strict";const e=window;let t=[];function n(e,t){const n=e.placeholder;e.placeholder="No Query!",e.classList.add("no-query"),t.classList.add("no-query"),setTimeout((()=>{e.placeholder=n,e.classList.remove("no-query"),t.classList.remove("no-query")}),800)}function o(n){return(o,r)=>{const s=document.createElement("a"),c=r.toUpperCase();return s.innerText=c+" x",s.classList.add("tag-link"),s.classList.add("for-search"),void 0!==e.tags[c]?(s.style.color=e.tags[c].color,s.style.backgroundColor=e.tags[c]["background-color"],t.push(c)):s.innerText="â“UNREGISTERED TAG x",s.addEventListener("click",(e=>{e.preventDefault(),function(e){const n=e.target,o=t.findIndex((e=>e===n.innerText.slice(0,-2)));t.splice(o,1),n.remove()}(e)})),n.appendChild(s),""}}!function(){const e=document.getElementById("search-box"),r=document.getElementById("search-wrapper"),s=r.querySelector("#tag-holder");r.querySelector(".inner-search").addEventListener("click",(()=>{c.dispatchEvent(new Event("submit"))}));const c=document.getElementById("search-form");e.addEventListener("focusin",(()=>{e.classList.contains("no-query")||(e.placeholder='Prefix "#" to add Tag.')})),e.addEventListener("focusout",(()=>{e.placeholder=""})),e.addEventListener("input",(()=>{e.value.length>0?e.classList.add("inputted"):e.classList.remove("inputted"),e.value=e.value.replaceAll(/#([^# ]+) /g,o(s))})),e.addEventListener("keydown",(n=>{(function(e,t){return document.activeElement===e&&"Backspace"===t.code&&""===e.value})(e,n)&&function(e){t.pop(),e.hasChildNodes()&&e.removeChild(e.lastChild)}(s)})),c.addEventListener("submit",(c=>{c.preventDefault(),""!==e.value||0!==t.length?function(e,n){e.value=e.value.replaceAll(/#([^# ]+)/g,o(n));let r=`search.html?query=${e.value}`;if(t.length>0){r+="&tags=";for(const e of t)r+=`${e}|`;r=r.slice(0,-1)}t=[],window.location.replace(r)}(e,s):n(e,r)})),r.addEventListener("click",(()=>{e.focus()}))}();const r=window;function s(e,t){const n=document.createElement("a");return n.classList.add("tag-link"),n.href=`/search.html?tags=${e}`,n.innerText=e,t?n.classList.add("emphasis"):(n.style.color=r.tags[e].color,n.style.backgroundColor=r.tags[e]["background-color"]),n}const c=window;function a(e,t){const n=document.createElement("li");n.appendChild(function(e){const t=document.createElement("span");return t.classList.add("post-meta"),t.innerText=e,t}(e.date));for(const o of e.tags)n.appendChild(s(o,t.includes(o)));return n.appendChild(function(e,t,n){const o=document.createElement("h3"),r=document.createElement("a");r.classList.add("post-link");for(const n of e)t=t.replaceAll(new RegExp(n.query,"gi"),(e=>`<mark>${e}</mark>`));return r.innerHTML=t,r.href=n,o.appendChild(r),o}(e.titleMatchs,e.title,e.url)),n.appendChild(function(e,t){const n=document.createElement("p");if(e.length>0){const o=Math.max(e[0].position[0][0]-50,0),r=Math.min(e[0].position[0][0]+e[0].position[0][1]+150,t.length);t=t.substring(o,r);for(const n of e)t=t.replaceAll(new RegExp(n.query,"gi"),(e=>`<mark>${e}</mark>`));n.innerHTML=t+"..."}else n.innerHTML=t.substring(0,200)+"...";return n}(e.contentMatchs,e.content)),n}!function(){const e=function(){const e=window.location.search,t=new URLSearchParams(e);let n=t.get("query");n=null!==n?decodeURIComponent(n.replace(/\+/g,"%20")):"";let o=t.get("tags")?.split("|").map(decodeURIComponent).map((e=>e.toUpperCase())).filter((e=>null!=e.match(/[^ ]/)));return o=void 0!==o?o:[],{query:n,tags:o}}();if(""===e.query&&0===e.tags.length){const e=document.querySelector(".post-list-heading"),t=document.getElementById("search-box"),o=document.getElementById("search-wrapper");return e.innerHTML="You entered No Query!",e.style.color="red",e.style.fontSize="xx-large",void n(t,o)}!function(e){const t=document.getElementById("search-box"),n=document.querySelector("#tag-holder");t.value=`${e.query}`;for(const n of e.tags)t.value+=` #${n}`;t.value=t.value.replaceAll(/#([^# ]+)/g,o(n)),null===e.query.match(/[^ ]/)&&(t.value=""),t.dispatchEvent(new Event("input")),t.dispatchEvent(new Event("focusin"))}(e),function(e,t){const n=document.getElementById("query-results");n.querySelector(".query-str").innerHTML=`<mark>${t.query}</mark>`;const o=n.querySelector(".post-list"),r=n.querySelector(".query-tags");for(const e of t.tags){const n=s(e,t.tags.includes(e));r.appendChild(n)}if(e.length>0){o.innerHTML="";for(const n of e)o.append(a(n,t.tags))}}(function(e){if(""===e.query)return function(e){const t=[];for(const n of Object.keys(c.store)){const o=c.store[n];let r=!1;for(const t of e)if(!o.tags.includes(t)){r=!0;break}r||t.push({url:o.url,date:o.date,tags:o.tags.map((e=>e.toUpperCase())),title:o.title,titleMatchs:[],content:o.content,contentMatchs:[]})}return t}(e.tags);const t=function(e,t){return e.filter((e=>{for(const n of t.tags)if(!c.store[e.ref].tags.includes(n.toUpperCase()))return!1;return!0}))}(""!==e.query?window.searchIndex.search(e.query):[],e);return function(e){const t=[];for(let n=0;n<e.length;n++){const o=c.store[e[n].ref],r=e[n].matchData.metadata,s=Object.keys(r),a=[],l=[];for(const e of s)void 0!==r[e].content&&l.push({query:e,position:r[e].content.position}),void 0!==r[e].title&&a.push({query:e,position:r[e].title.position});t.push({url:o.url,date:o.date,tags:o.tags.map((e=>e.toUpperCase())),title:o.title,titleMatchs:a,content:o.content,contentMatchs:l})}return t}(t)}(e),e)}()})();